<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICA Practice Questions - Hands-On Lab Exercises</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0e17;
            --bg-secondary: #111827;
            --bg-tertiary: #1a2234;
            --bg-card: #151d2e;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --install-primary: #06b6d4;
            --install-bg: rgba(6, 182, 212, 0.08);
            --install-border: rgba(6, 182, 212, 0.3);
            --traffic-primary: #8b5cf6;
            --traffic-bg: rgba(139, 92, 246, 0.08);
            --traffic-border: rgba(139, 92, 246, 0.3);
            --security-primary: #10b981;
            --security-bg: rgba(16, 185, 129, 0.08);
            --security-border: rgba(16, 185, 129, 0.3);
            --troubleshoot-primary: #f59e0b;
            --troubleshoot-bg: rgba(245, 158, 11, 0.08);
            --troubleshoot-border: rgba(245, 158, 11, 0.3);
            --code-bg: #0d1117;
            --code-border: #30363d;
            --success: #22c55e;
            --success-bg: rgba(34, 197, 94, 0.1);
            --warning-bg: rgba(245, 158, 11, 0.1);
            --warning-border: rgba(245, 158, 11, 0.3);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg-primary); color: var(--text-primary); line-height: 1.8; }
        .bg-mesh { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: radial-gradient(ellipse at 20% 20%, rgba(6, 182, 212, 0.12) 0%, transparent 50%), radial-gradient(ellipse at 80% 80%, rgba(139, 92, 246, 0.12) 0%, transparent 50%); }
        .container { max-width: 1100px; margin: 0 auto; padding: 0 24px; }
        .header { padding: 60px 24px; text-align: center; border-bottom: 1px solid var(--bg-tertiary); }
        .header-badge { display: inline-flex; align-items: center; gap: 8px; background: linear-gradient(135deg, var(--traffic-bg), var(--install-bg)); border: 1px solid var(--traffic-border); padding: 8px 20px; border-radius: 100px; font-size: 0.85rem; font-weight: 600; color: var(--traffic-primary); margin-bottom: 24px; }
        .header h1 { font-family: 'Space Grotesk', sans-serif; font-size: clamp(2rem, 5vw, 3.5rem); font-weight: 700; margin-bottom: 16px; background: linear-gradient(135deg, var(--text-primary), var(--traffic-primary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .header p { color: var(--text-secondary); font-size: 1.1rem; max-width: 700px; margin: 0 auto 20px; }
        .header-note { background: var(--bg-tertiary); border-radius: 12px; padding: 16px 24px; max-width: 800px; margin: 0 auto; text-align: left; }
        .header-note h3 { color: var(--install-primary); font-size: 0.9rem; margin-bottom: 8px; }
        .header-note ul { color: var(--text-secondary); font-size: 0.9rem; margin-left: 20px; }
        .header-note li { margin-bottom: 4px; }
        .stats-bar { display: flex; justify-content: center; gap: 32px; padding: 24px; background: var(--bg-secondary); border-bottom: 1px solid var(--bg-tertiary); flex-wrap: wrap; }
        .stat { text-align: center; }
        .stat-value { font-family: 'Space Grotesk', sans-serif; font-size: 2rem; font-weight: 700; }
        .stat-label { font-size: 0.85rem; color: var(--text-muted); }
        .stat.install .stat-value { color: var(--install-primary); }
        .stat.traffic .stat-value { color: var(--traffic-primary); }
        .stat.security .stat-value { color: var(--security-primary); }
        .stat.troubleshoot .stat-value { color: var(--troubleshoot-primary); }
        .domain-nav { display: flex; justify-content: center; gap: 12px; padding: 24px; background: var(--bg-card); position: sticky; top: 0; z-index: 100; border-bottom: 1px solid var(--bg-tertiary); flex-wrap: wrap; }
        .domain-nav a { padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 0.9rem; transition: all 0.2s ease; }
        .domain-nav a.install { background: var(--install-bg); color: var(--install-primary); border: 1px solid var(--install-border); }
        .domain-nav a.traffic { background: var(--traffic-bg); color: var(--traffic-primary); border: 1px solid var(--traffic-border); }
        .domain-nav a.security { background: var(--security-bg); color: var(--security-primary); border: 1px solid var(--security-border); }
        .domain-nav a.troubleshoot { background: var(--troubleshoot-bg); color: var(--troubleshoot-primary); border: 1px solid var(--troubleshoot-border); }
        .domain-nav a:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
        .domain-section { padding: 60px 0; }
        .domain-header { margin-bottom: 40px; }
        .domain-badge { display: inline-flex; align-items: center; gap: 8px; padding: 6px 16px; border-radius: 100px; font-size: 0.8rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 16px; }
        .domain-section.install .domain-badge { background: var(--install-bg); color: var(--install-primary); border: 1px solid var(--install-border); }
        .domain-section.traffic .domain-badge { background: var(--traffic-bg); color: var(--traffic-primary); border: 1px solid var(--traffic-border); }
        .domain-section.security .domain-badge { background: var(--security-bg); color: var(--security-primary); border: 1px solid var(--security-border); }
        .domain-section.troubleshoot .domain-badge { background: var(--troubleshoot-bg); color: var(--troubleshoot-primary); border: 1px solid var(--troubleshoot-border); }
        .domain-title { font-family: 'Space Grotesk', sans-serif; font-size: 2rem; font-weight: 700; margin-bottom: 8px; }
        .domain-section.install .domain-title { color: var(--install-primary); }
        .domain-section.traffic .domain-title { color: var(--traffic-primary); }
        .domain-section.security .domain-title { color: var(--security-primary); }
        .domain-section.troubleshoot .domain-title { color: var(--troubleshoot-primary); }
        .domain-description { color: var(--text-secondary); max-width: 800px; }
        .question-card { background: var(--bg-card); border-radius: 16px; margin-bottom: 24px; border: 1px solid var(--bg-tertiary); overflow: hidden; }
        .question-header { padding: 24px; cursor: pointer; display: flex; align-items: flex-start; gap: 16px; transition: background 0.2s ease; }
        .question-header:hover { background: var(--bg-tertiary); }
        .question-number { width: 44px; height: 44px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: 700; font-family: 'Space Grotesk', sans-serif; flex-shrink: 0; font-size: 1.1rem; }
        .domain-section.install .question-number { background: var(--install-bg); color: var(--install-primary); border: 1px solid var(--install-border); }
        .domain-section.traffic .question-number { background: var(--traffic-bg); color: var(--traffic-primary); border: 1px solid var(--traffic-border); }
        .domain-section.security .question-number { background: var(--security-bg); color: var(--security-primary); border: 1px solid var(--security-border); }
        .domain-section.troubleshoot .question-number { background: var(--troubleshoot-bg); color: var(--troubleshoot-primary); border: 1px solid var(--troubleshoot-border); }
        .question-content { flex: 1; }
        .question-title { font-family: 'Space Grotesk', sans-serif; font-size: 1.15rem; font-weight: 600; margin-bottom: 8px; color: var(--text-primary); }
        .question-description { color: var(--text-secondary); font-size: 0.95rem; line-height: 1.6; }
        .question-toggle { width: 36px; height: 36px; border-radius: 8px; background: var(--bg-tertiary); display: flex; align-items: center; justify-content: center; color: var(--text-muted); transition: all 0.3s ease; flex-shrink: 0; font-size: 0.9rem; }
        .question-card.open .question-toggle { transform: rotate(180deg); background: var(--traffic-bg); color: var(--traffic-primary); }
        .answer-section { display: none; padding: 0 24px 24px; border-top: 1px solid var(--bg-tertiary); }
        .question-card.open .answer-section { display: block; }
        .sub-section { margin-top: 28px; }
        .sub-section:first-child { margin-top: 24px; }
        .sub-section-title { font-family: 'Space Grotesk', sans-serif; font-size: 0.85rem; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 16px; display: flex; align-items: center; gap: 10px; padding-bottom: 8px; border-bottom: 1px solid var(--bg-tertiary); }
        .sub-section-title.prereq { color: var(--install-primary); }
        .sub-section-title.task { color: var(--traffic-primary); }
        .sub-section-title.solution { color: var(--security-primary); }
        .sub-section-title.expected { color: var(--troubleshoot-primary); }
        .sub-section-title.reference { color: var(--text-muted); }
        .sub-section-title.cleanup { color: #ef4444; }
        .narrative { color: var(--text-secondary); margin-bottom: 16px; font-size: 0.95rem; line-height: 1.7; }
        .narrative strong { color: var(--text-primary); }
        .narrative code { background: var(--bg-tertiary); padding: 2px 6px; border-radius: 4px; font-size: 0.85em; font-family: 'JetBrains Mono', monospace; color: var(--install-primary); }
        .task-list { color: var(--text-secondary); margin: 16px 0 16px 24px; font-size: 0.95rem; }
        .task-list li { margin-bottom: 8px; line-height: 1.6; }
        .task-list strong { color: var(--text-primary); }
        .code-container { position: relative; margin: 16px 0; }
        .code-header { display: flex; align-items: center; justify-content: space-between; background: #21262d; padding: 10px 16px; border-radius: 10px 10px 0 0; font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; }
        .code-lang { color: var(--text-muted); display: flex; align-items: center; gap: 8px; }
        .code-lang::before { content: ''; width: 10px; height: 10px; border-radius: 50%; }
        .code-lang.bash::before { background: var(--security-primary); }
        .code-lang.yaml::before { background: var(--traffic-primary); }
        .code-lang.output::before { background: var(--troubleshoot-primary); }
        .copy-btn { background: transparent; border: 1px solid var(--text-muted); color: var(--text-muted); padding: 4px 12px; border-radius: 6px; cursor: pointer; font-family: 'Plus Jakarta Sans', sans-serif; font-size: 0.75rem; font-weight: 500; transition: all 0.2s ease; }
        .copy-btn:hover { background: var(--text-muted); color: var(--bg-primary); }
        .copy-btn.copied { background: var(--security-primary); border-color: var(--security-primary); color: white; }
        pre { background: var(--code-bg); padding: 20px; border-radius: 0 0 10px 10px; overflow-x: auto; font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; line-height: 1.7; border: 1px solid var(--code-border); border-top: none; color: #c9d1d9; }
        pre .comment { color: #8b949e; }
        .expected-box { background: var(--success-bg); border: 1px solid rgba(34, 197, 94, 0.3); border-radius: 12px; padding: 20px; margin-top: 16px; }
        .expected-box h4 { color: var(--success); font-size: 0.9rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        .expected-box p, .expected-box li { color: var(--text-secondary); font-size: 0.9rem; line-height: 1.6; }
        .expected-box ul { margin-left: 20px; margin-top: 8px; }
        .expected-box li { margin-bottom: 4px; }
        .tip-box { background: var(--traffic-bg); border: 1px solid var(--traffic-border); border-radius: 12px; padding: 20px; margin-top: 16px; }
        .tip-box h4 { color: var(--traffic-primary); font-size: 0.9rem; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
        .tip-box p { color: var(--text-secondary); font-size: 0.9rem; }
        .warning-box { background: var(--warning-bg); border: 1px solid var(--warning-border); border-radius: 12px; padding: 20px; margin-top: 16px; }
        .warning-box h4 { color: var(--troubleshoot-primary); font-size: 0.9rem; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
        .warning-box p { color: var(--text-secondary); font-size: 0.9rem; }
        .reference-links { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 12px; }
        .ref-link { display: inline-flex; align-items: center; gap: 6px; padding: 8px 14px; background: var(--bg-tertiary); border-radius: 8px; color: var(--text-secondary); text-decoration: none; font-size: 0.85rem; transition: all 0.2s ease; border: 1px solid transparent; }
        .ref-link:hover { background: var(--traffic-bg); color: var(--traffic-primary); border-color: var(--traffic-border); }
        /* Domain Summary Cards */
        .domain-summary { background: var(--bg-card); border-radius: 16px; padding: 28px; margin-top: 40px; border: 1px solid var(--bg-tertiary); position: relative; overflow: hidden; }
        .domain-summary::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; }
        .domain-summary.install::before { background: linear-gradient(90deg, var(--install-primary), transparent); }
        .domain-summary.traffic::before { background: linear-gradient(90deg, var(--traffic-primary), transparent); }
        .domain-summary.security::before { background: linear-gradient(90deg, var(--security-primary), transparent); }
        .domain-summary.troubleshoot::before { background: linear-gradient(90deg, var(--troubleshoot-primary), transparent); }
        .domain-summary-header { display: flex; align-items: center; gap: 12px; margin-bottom: 20px; }
        .domain-summary-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; }
        .domain-summary.install .domain-summary-icon { background: var(--install-bg); border: 1px solid var(--install-border); }
        .domain-summary.traffic .domain-summary-icon { background: var(--traffic-bg); border: 1px solid var(--traffic-border); }
        .domain-summary.security .domain-summary-icon { background: var(--security-bg); border: 1px solid var(--security-border); }
        .domain-summary.troubleshoot .domain-summary-icon { background: var(--troubleshoot-bg); border: 1px solid var(--troubleshoot-border); }
        .domain-summary-title { font-family: 'Space Grotesk', sans-serif; font-size: 1.1rem; font-weight: 700; }
        .domain-summary.install .domain-summary-title { color: var(--install-primary); }
        .domain-summary.traffic .domain-summary-title { color: var(--traffic-primary); }
        .domain-summary.security .domain-summary-title { color: var(--security-primary); }
        .domain-summary.troubleshoot .domain-summary-title { color: var(--troubleshoot-primary); }
        .domain-summary-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 12px; }
        .domain-summary-item { display: flex; align-items: center; gap: 10px; padding: 10px 14px; background: var(--bg-tertiary); border-radius: 8px; font-size: 0.85rem; }
        .domain-summary-item .q-num { font-family: 'Space Grotesk', sans-serif; font-weight: 700; min-width: 32px; }
        .domain-summary.install .q-num { color: var(--install-primary); }
        .domain-summary.traffic .q-num { color: var(--traffic-primary); }
        .domain-summary.security .q-num { color: var(--security-primary); }
        .domain-summary.troubleshoot .q-num { color: var(--troubleshoot-primary); }
        .domain-summary-item .q-title { color: var(--text-secondary); }
        /* Final Summary Card */
        .final-summary { background: linear-gradient(135deg, var(--bg-card) 0%, var(--bg-tertiary) 100%); border-radius: 20px; padding: 36px; margin-top: 32px; border: 1px solid var(--bg-tertiary); text-align: center; position: relative; overflow: hidden; }
        .final-summary::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, var(--install-primary), var(--traffic-primary), var(--security-primary), var(--troubleshoot-primary)); }
        .final-summary h3 { font-family: 'Space Grotesk', sans-serif; font-size: 1.5rem; font-weight: 700; margin-bottom: 8px; background: linear-gradient(135deg, var(--text-primary), var(--traffic-primary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .final-summary p { color: var(--text-secondary); margin-bottom: 24px; }
        .final-summary-stats { display: flex; justify-content: center; gap: 24px; flex-wrap: wrap; margin-bottom: 20px; }
        .final-stat { text-align: center; padding: 16px 24px; background: var(--bg-primary); border-radius: 12px; min-width: 140px; }
        .final-stat-value { font-family: 'Space Grotesk', sans-serif; font-size: 1.5rem; font-weight: 700; }
        .final-stat-label { font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }
        .final-stat.install .final-stat-value { color: var(--install-primary); }
        .final-stat.traffic .final-stat-value { color: var(--traffic-primary); }
        .final-stat.security .final-stat-value { color: var(--security-primary); }
        .final-stat.troubleshoot .final-stat-value { color: var(--troubleshoot-primary); }
        .final-summary .good-luck { color: var(--success); font-weight: 600; font-size: 1.1rem; }
        /* Brief Section */
        .brief-section { background: var(--bg-secondary); padding: 48px 24px; border-bottom: 1px solid var(--bg-tertiary); }
        .brief-container { max-width: 900px; margin: 0 auto; }
        .brief-title { font-family: 'Space Grotesk', sans-serif; font-size: 1.4rem; font-weight: 700; color: var(--text-primary); margin-bottom: 16px; display: flex; align-items: center; gap: 10px; }
        .brief-content { color: var(--text-secondary); line-height: 1.8; }
        .brief-content p { margin-bottom: 16px; }
        .brief-features { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin-top: 24px; }
        .brief-feature { display: flex; align-items: flex-start; gap: 12px; padding: 16px; background: var(--bg-card); border-radius: 12px; border: 1px solid var(--bg-tertiary); }
        .brief-feature-icon { font-size: 1.3rem; }
        .brief-feature-text { color: var(--text-secondary); font-size: 0.9rem; }
        .brief-feature-text strong { color: var(--text-primary); display: block; margin-bottom: 4px; }
        footer { background: var(--bg-secondary); padding: 40px 24px; text-align: center; border-top: 1px solid var(--bg-tertiary); }
        .footer-links { display: flex; justify-content: center; gap: 24px; margin-bottom: 16px; flex-wrap: wrap; }
        .footer-links a { color: var(--text-muted); text-decoration: none; transition: color 0.2s; }
        .footer-links a:hover { color: var(--traffic-primary); }
        .footer-credit { color: var(--text-muted); font-size: 0.85rem; }
        @media (max-width: 768px) { .question-header { flex-wrap: wrap; } .stats-bar { gap: 16px; } .header-note { padding: 12px 16px; } }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-secondary); }
        ::-webkit-scrollbar-thumb { background: var(--bg-tertiary); border-radius: 4px; }
    </style>
</head>
<body>
    <div class="bg-mesh"></div>

    <header class="header">
        <div class="header-badge"><span>üß™</span><span>Hands-On Practice Lab</span></div>
        <h1>ICA Practice Questions</h1>
        <p>46 comprehensive hands-on lab exercises covering all exam domains. Master Istio service mesh through practical scenarios.</p>
    </header>

    <!-- Brief Introduction Section -->
    <section class="brief-section">
        <div class="brief-container">
            <h2 class="brief-title">üìò About This Practice Lab</h2>
            <div class="brief-content">
                <p>This practice lab contains <strong>46 hands-on questions</strong> designed to prepare you for the <strong>Istio Certified Associate (ICA)</strong> exam. Each question presents a realistic scenario you might encounter in the actual exam or in production environments.</p>
                <p>Questions are organized by exam domains with accurate weight distribution. All commands have been verified for <strong>Istio 1.28.x</strong> and follow current best practices.</p>
            </div>
            <div class="brief-features">
                <div class="brief-feature">
                    <div class="brief-feature-icon">üéØ</div>
                    <div class="brief-feature-text">
                        <strong>Exam-Realistic Scenarios</strong>
                        Task-based questions matching actual exam format
                    </div>
                </div>
                <div class="brief-feature">
                    <div class="brief-feature-icon">üîÑ</div>
                    <div class="brief-feature-text">
                        <strong>Independent Questions</strong>
                        Complete any question in any order with full cleanup
                    </div>
                </div>
                <div class="brief-feature">
                    <div class="brief-feature-icon">‚úÖ</div>
                    <div class="brief-feature-text">
                        <strong>Verification Steps</strong>
                        Expected results to confirm your solution is correct
                    </div>
                </div>
                <div class="brief-feature">
                    <div class="brief-feature-icon">üìö</div>
                    <div class="brief-feature-text">
                        <strong>Official References</strong>
                        Direct links to Istio documentation for deeper learning
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Lab Environment Info -->
    <section class="brief-section" style="padding: 32px 24px; background: var(--bg-card);">
        <div class="brief-container">
            <h2 class="brief-title">üñ•Ô∏è Lab Environment Requirements</h2>
            <div class="brief-content">
                <p>These exercises can be completed on any Kubernetes environment with Istio installed. Below are some recommended options:</p>
            </div>
            <div class="brief-features">
                <div class="brief-feature">
                    <div class="brief-feature-icon">‚òÅÔ∏è</div>
                    <div class="brief-feature-text">
                        <strong>Cloud Playgrounds</strong>
                        KodeKloud, Killercoda, or Play with Kubernetes
                    </div>
                </div>
                <div class="brief-feature">
                    <div class="brief-feature-icon">üíª</div>
                    <div class="brief-feature-text">
                        <strong>Local Clusters</strong>
                        Minikube, kind, k3d, or Docker Desktop
                    </div>
                </div>
                <div class="brief-feature">
                    <div class="brief-feature-icon">üè¢</div>
                    <div class="brief-feature-text">
                        <strong>Managed Kubernetes</strong>
                        GKE, EKS, AKS with Istio addon or manual install
                    </div>
                </div>
                <div class="brief-feature">
                    <div class="brief-feature-icon">‚öôÔ∏è</div>
                    <div class="brief-feature-text">
                        <strong>Required Tools</strong>
                        kubectl, istioctl (1.28.x), and cluster admin access
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="stats-bar">
        <div class="stat install"><div class="stat-value">12</div><div class="stat-label">Installation (20%)</div></div>
        <div class="stat traffic"><div class="stat-value">12</div><div class="stat-label">Traffic Mgmt (35%)</div></div>
        <div class="stat security"><div class="stat-value">12</div><div class="stat-label">Security (25%)</div></div>
        <div class="stat troubleshoot"><div class="stat-value">10</div><div class="stat-label">Troubleshooting (20%)</div></div>
    </div>

    <nav class="domain-nav">
        <a href="#install" class="install">‚öôÔ∏è Installation (12)</a>
        <a href="#traffic" class="traffic">üîÄ Traffic Management (12)</a>
        <a href="#security" class="security">üîê Security (12)</a>
        <a href="#troubleshoot" class="troubleshoot">üîß Troubleshooting (10)</a>
    </nav>

    <!-- DOMAIN 1: INSTALLATION -->
    <section id="install" class="domain-section install">
        <div class="container">
            <div class="domain-header">
                <div class="domain-badge">Domain 1 ‚Ä¢ 20% of Exam ‚Ä¢ 12 Questions</div>
                <h2 class="domain-title">Installation, Upgrade & Configuration</h2>
                <p class="domain-description">Master Istio installation methods, configuration profiles, sidecar injection, mesh configuration, and upgrade strategies.</p>
            </div>

            <!-- QUESTION 1 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">1</div>
                    <div class="question-content">
                        <div class="question-title">Verify Istio Installation and Component Health</div>
                        <div class="question-description">You have joined a new team and need to verify the current Istio installation. Check the installed version, verify all control plane components are healthy, and confirm the data plane proxies are in sync.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <p class="narrative">Istio should be pre-installed on the cluster. Verify you have access to <code>istioctl</code> and <code>kubectl</code>.</p>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Verify CLI tools are available</span>
which istioctl
which kubectl

<span class="comment"># Verify cluster access</span>
kubectl cluster-info</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Check the Istio version for client, control plane, and data plane</li>
                            <li><strong>Task 2:</strong> Verify all Istio control plane pods are running in <code>istio-system</code> namespace</li>
                            <li><strong>Task 3:</strong> Use <code>istioctl proxy-status</code> to verify all proxies are in SYNCED state</li>
                            <li><strong>Task 4:</strong> Run <code>istioctl analyze</code> to check for configuration issues in the mesh</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Check Istio version (client, control plane, data plane)</span>
istioctl version

<span class="comment"># Task 2: Verify control plane pods are running</span>
kubectl get pods -n istio-system

<span class="comment"># Check that istiod is ready</span>
kubectl get deployment istiod -n istio-system

<span class="comment"># Task 3: Check proxy sync status</span>
istioctl proxy-status

<span class="comment"># Task 4: Analyze mesh configuration for issues</span>
istioctl analyze --all-namespaces</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>istioctl proxy-status</strong> columns: SYNCED means proxy config is current. STALE means proxy hasn't received updates. NOT SENT means istiod hasn't pushed config yet.<br><br>
                            <strong>istioctl analyze</strong> finds misconfigurations like missing destinations, conflicting policies, or deprecated settings.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li><code>istioctl version</code> shows matching versions for client, control plane, and data plane</li>
                                <li>All pods in <code>istio-system</code> are in <code>Running</code> state with all containers ready</li>
                                <li><code>istioctl proxy-status</code> shows all proxies as <code>SYNCED</code> for CDS, LDS, EDS, RDS</li>
                                <li><code>istioctl analyze</code> reports no errors (warnings are acceptable)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <p class="narrative">This exercise is read-only verification. No resources were created, so no cleanup is required.</p>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/commands/istioctl/#istioctl-version" target="_blank" class="ref-link">üìñ istioctl version</a>
                            <a href="https://istio.io/latest/docs/reference/commands/istioctl/#istioctl-proxy-status" target="_blank" class="ref-link">üìñ istioctl proxy-status</a>
                            <a href="https://istio.io/latest/docs/reference/commands/istioctl/#istioctl-analyze" target="_blank" class="ref-link">üìñ istioctl analyze</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 2 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">2</div>
                    <div class="question-content">
                        <div class="question-title">Enable Envoy Access Logging for Debugging</div>
                        <div class="question-description">Your team is troubleshooting intermittent 503 errors in production. Enable Envoy access logging to capture request details. Configure JSON-formatted logging to stdout for all sidecar proxies and verify logs are being generated.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <p class="narrative">Create a test namespace with sample applications to generate traffic for log verification.</p>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Create namespace for testing</span>
kubectl create namespace logging-test

<span class="comment"># Enable sidecar injection</span>
kubectl label namespace logging-test istio-injection=enabled

<span class="comment"># Deploy httpbin (server) and sleep (client) applications</span>
kubectl apply -n logging-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n logging-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

<span class="comment"># Wait for pods to be ready</span>
kubectl wait --for=condition=ready pod -l app=httpbin -n logging-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n logging-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Enable access logging by updating the Istio mesh configuration to log to <code>/dev/stdout</code> with <code>JSON</code> encoding</li>
                            <li><strong>Task 2:</strong> Restart the test pods to pick up the new logging configuration</li>
                            <li><strong>Task 3:</strong> Generate HTTP traffic from the sleep pod to httpbin service</li>
                            <li><strong>Task 4:</strong> View the access logs from the httpbin pod's istio-proxy container and confirm JSON format</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Enable access logging via istioctl</span>
istioctl install --set meshConfig.accessLogFile=/dev/stdout --set meshConfig.accessLogEncoding=JSON -y

<span class="comment"># Verify the configuration was applied</span>
kubectl get configmap istio -n istio-system -o jsonpath='{.data.mesh}' | grep accessLog

<span class="comment"># Task 2: Restart pods to pick up new config</span>
kubectl rollout restart deployment/httpbin -n logging-test
kubectl rollout restart deployment/sleep -n logging-test

<span class="comment"># Wait for pods to be ready again</span>
kubectl wait --for=condition=ready pod -l app=httpbin -n logging-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n logging-test --timeout=120s

<span class="comment"># Task 3: Generate traffic</span>
kubectl exec -n logging-test deploy/sleep -- curl -s httpbin:8000/ip
kubectl exec -n logging-test deploy/sleep -- curl -s httpbin:8000/headers
kubectl exec -n logging-test deploy/sleep -- curl -s httpbin:8000/status/200

<span class="comment"># Task 4: View access logs (JSON format)</span>
kubectl logs -n logging-test deploy/httpbin -c istio-proxy --tail=10</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p>Access logs are essential for debugging. Key fields in JSON logs:<br>
                            ‚Ä¢ <code>response_code</code> - HTTP status (200, 503, etc.)<br>
                            ‚Ä¢ <code>upstream_cluster</code> - Where traffic was routed<br>
                            ‚Ä¢ <code>duration</code> - Request time in milliseconds<br>
                            ‚Ä¢ <code>response_flags</code> - Envoy flags like UC (upstream connection failure), UF (upstream failure)</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>ConfigMap <code>istio</code> shows <code>accessLogFile: /dev/stdout</code> and <code>accessLogEncoding: JSON</code></li>
                                <li>Both pods show <code>2/2</code> ready after restart</li>
                                <li>curl commands return successful responses (IP address, headers, etc.)</li>
                                <li>Logs from istio-proxy show JSON entries with fields: <code>authority</code>, <code>method</code>, <code>path</code>, <code>response_code</code>, <code>upstream_cluster</code></li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <p class="narrative">Remove all resources created and optionally disable access logging:</p>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Delete the test namespace and all resources</span>
kubectl delete namespace logging-test

<span class="comment"># Verify namespace is deleted</span>
kubectl get namespace logging-test 2>/dev/null || echo "Namespace deleted successfully"

<span class="comment"># (Optional) Disable access logging - reinstall without accessLog settings</span>
<span class="comment"># istioctl install --set profile=default -y</span></pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/tasks/observability/logs/access-log/" target="_blank" class="ref-link">üìñ Envoy Access Logs</a>
                            <a href="https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig" target="_blank" class="ref-link">üìñ MeshConfig Reference</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 3 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">3</div>
                    <div class="question-content">
                        <div class="question-title">Onboard Application Namespace to Service Mesh</div>
                        <div class="question-description">A new microservice called "orders-api" needs to be onboarded to the Istio service mesh. Create the namespace, enable automatic sidecar injection, deploy the application, and verify it can communicate with other mesh services.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <p class="narrative">Verify Istio's sidecar injector webhook is available and the control plane is healthy.</p>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Verify sidecar injector webhook exists</span>
kubectl get mutatingwebhookconfiguration | grep istio

<span class="comment"># Verify istiod is running</span>
kubectl get pods -n istio-system -l app=istiod</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a namespace called <code>orders</code></li>
                            <li><strong>Task 2:</strong> Enable automatic sidecar injection for the namespace using the appropriate label</li>
                            <li><strong>Task 3:</strong> Deploy a simple nginx deployment named <code>orders-api</code> with 1 replica in the namespace</li>
                            <li><strong>Task 4:</strong> Verify the pod has 2 containers (application + istio-proxy sidecar)</li>
                            <li><strong>Task 5:</strong> Confirm the sidecar is connected to the control plane using <code>istioctl proxy-status</code></li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create namespace</span>
kubectl create namespace orders

<span class="comment"># Task 2: Enable sidecar injection</span>
kubectl label namespace orders istio-injection=enabled

<span class="comment"># Verify label was applied</span>
kubectl get namespace orders --show-labels

<span class="comment"># Task 3: Deploy orders-api application</span>
kubectl create deployment orders-api --image=nginx:1.24 -n orders

<span class="comment"># Wait for pod to be ready</span>
kubectl wait --for=condition=ready pod -l app=orders-api -n orders --timeout=120s

<span class="comment"># Task 4: Verify pod has 2 containers</span>
kubectl get pods -n orders

<span class="comment"># List container names in the pod</span>
kubectl get pod -l app=orders-api -n orders -o jsonpath='{.items[0].spec.containers[*].name}'
echo ""

<span class="comment"># Verify istio-proxy container is present</span>
kubectl get pod -l app=orders-api -n orders -o jsonpath='{range .items[0].spec.containers[*]}{.name}{": "}{.image}{"\n"}{end}'

<span class="comment"># Task 5: Check proxy is synced with control plane</span>
istioctl proxy-status | grep orders</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p>Two ways to enable injection:<br>
                            ‚Ä¢ <code>istio-injection=enabled</code> - Uses default Istio revision<br>
                            ‚Ä¢ <code>istio.io/rev=&lt;revision&gt;</code> - Uses specific revision (canary upgrades)<br><br>
                            The sidecar injector adds: <code>istio-init</code> (init container for iptables) and <code>istio-proxy</code> (Envoy sidecar)</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>Namespace <code>orders</code> exists with label <code>istio-injection=enabled</code></li>
                                <li>Pod shows <code>2/2</code> in READY column</li>
                                <li>Container names output: <code>orders-api istio-proxy</code></li>
                                <li><code>istioctl proxy-status</code> shows the orders-api pod as <code>SYNCED</code></li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <p class="narrative">Remove all resources created during this exercise:</p>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Delete the namespace (removes deployment, pods, and namespace)</span>
kubectl delete namespace orders

<span class="comment"># Verify cleanup</span>
kubectl get namespace orders 2>/dev/null || echo "Namespace deleted successfully"

<span class="comment"># Verify no pods remain</span>
kubectl get pods -n orders 2>/dev/null || echo "All pods cleaned up"</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/setup/additional-setup/sidecar-injection/" target="_blank" class="ref-link">üìñ Sidecar Injection</a>
                            <a href="https://istio.io/latest/docs/ops/configuration/mesh/injection-concepts/" target="_blank" class="ref-link">üìñ Injection Concepts</a>
                            <a href="https://istio.io/latest/docs/reference/commands/istioctl/#istioctl-proxy-status" target="_blank" class="ref-link">üìñ istioctl proxy-status</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 4 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">4</div>
                    <div class="question-content">
                        <div class="question-title">Exclude a Pod from Sidecar Injection</div>
                        <div class="question-description">Your team is deploying a legacy monitoring agent that is incompatible with the Istio sidecar. Deploy this pod in an injection-enabled namespace but prevent the sidecar from being injected using pod annotations.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <p class="narrative">Create a namespace with sidecar injection enabled to test selective exclusion.</p>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Create namespace with injection enabled</span>
kubectl create namespace monitoring
kubectl label namespace monitoring istio-injection=enabled
kubectl get namespace monitoring --show-labels</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a pod named <code>legacy-agent</code> with annotation <code>sidecar.istio.io/inject: "false"</code></li>
                            <li><strong>Task 2:</strong> Create another pod named <code>metrics-collector</code> WITHOUT the annotation (should get sidecar)</li>
                            <li><strong>Task 3:</strong> Verify <code>legacy-agent</code> has only 1 container (no sidecar)</li>
                            <li><strong>Task 4:</strong> Verify <code>metrics-collector</code> has 2 containers (with sidecar)</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create pod WITH injection disabled</span>
kubectl run legacy-agent --image=nginx:1.24 -n monitoring \
  --overrides='{"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}}}'

<span class="comment"># Task 2: Create pod WITHOUT annotation (will get sidecar)</span>
kubectl run metrics-collector --image=nginx:1.24 -n monitoring

<span class="comment"># Wait for pods</span>
kubectl wait --for=condition=ready pod/legacy-agent -n monitoring --timeout=60s
kubectl wait --for=condition=ready pod/metrics-collector -n monitoring --timeout=60s

<span class="comment"># Task 3 & 4: Verify container counts</span>
kubectl get pods -n monitoring

<span class="comment"># Check legacy-agent containers (should be 1)</span>
kubectl get pod legacy-agent -n monitoring -o jsonpath='{.spec.containers[*].name}'
echo ""

<span class="comment"># Check metrics-collector containers (should be 2)</span>
kubectl get pod metrics-collector -n monitoring -o jsonpath='{.spec.containers[*].name}'
echo ""</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p>The annotation <code>sidecar.istio.io/inject: "false"</code> overrides namespace-level injection. Use for legacy apps, jobs that need clean termination, or infrastructure pods.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li><code>legacy-agent</code> shows <code>1/1</code> READY (no sidecar)</li>
                                <li><code>metrics-collector</code> shows <code>2/2</code> READY (has sidecar)</li>
                                <li>legacy-agent containers: <code>legacy-agent</code> only</li>
                                <li>metrics-collector containers: <code>metrics-collector istio-proxy</code></li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace monitoring
kubectl get namespace monitoring 2>/dev/null || echo "Namespace deleted"</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/setup/additional-setup/sidecar-injection/#controlling-the-injection-policy" target="_blank" class="ref-link">üìñ Controlling Injection Policy</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 5 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">5</div>
                    <div class="question-content">
                        <div class="question-title">Restrict Outbound Traffic to Registered Services Only</div>
                        <div class="question-description">For security compliance, configure the mesh to block traffic to external services unless explicitly registered via ServiceEntry. Set outbound traffic policy to REGISTRY_ONLY.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <p class="narrative">Deploy a test application to verify outbound traffic behavior.</p>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Create test namespace</span>
kubectl create namespace egress-test
kubectl label namespace egress-test istio-injection=enabled

<span class="comment"># Deploy sleep app</span>
kubectl apply -n egress-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml
kubectl wait --for=condition=ready pod -l app=sleep -n egress-test --timeout=120s

<span class="comment"># Test current access (should work with default ALLOW_ANY)</span>
kubectl exec -n egress-test deploy/sleep -- curl -sI https://httpbin.org/get --max-time 5 | head -1</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Check the current outbound traffic policy setting</li>
                            <li><strong>Task 2:</strong> Configure mesh to use <code>REGISTRY_ONLY</code> outbound policy</li>
                            <li><strong>Task 3:</strong> Restart test pod and verify external traffic is blocked</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Check current policy</span>
kubectl get configmap istio -n istio-system -o jsonpath='{.data.mesh}' | grep outboundTrafficPolicy || echo "Using default (ALLOW_ANY)"

<span class="comment"># Task 2: Set REGISTRY_ONLY policy</span>
istioctl install --set meshConfig.outboundTrafficPolicy.mode=REGISTRY_ONLY -y

<span class="comment"># Verify setting</span>
kubectl get configmap istio -n istio-system -o jsonpath='{.data.mesh}' | grep -A1 outboundTrafficPolicy

<span class="comment"># Task 3: Restart pod and test</span>
kubectl rollout restart deployment/sleep -n egress-test
kubectl wait --for=condition=ready pod -l app=sleep -n egress-test --timeout=120s

<span class="comment"># Test external access (should fail)</span>
kubectl exec -n egress-test deploy/sleep -- curl -sI https://httpbin.org/get --max-time 5 2>&1 | head -3 || echo "Blocked as expected"</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>ALLOW_ANY</strong>: Access any external service (default)<br>
                            <strong>REGISTRY_ONLY</strong>: Only registered services (ServiceEntry) accessible</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>ConfigMap shows <code>outboundTrafficPolicy: mode: REGISTRY_ONLY</code></li>
                                <li>External curl to httpbin.org fails or times out</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace egress-test
istioctl install --set meshConfig.outboundTrafficPolicy.mode=ALLOW_ANY -y</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/tasks/traffic-management/egress/egress-control/" target="_blank" class="ref-link">üìñ Egress Traffic Control</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 6 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">6</div>
                    <div class="question-content">
                        <div class="question-title">Manually Inject Sidecar Using istioctl</div>
                        <div class="question-description">Add a workload to the mesh in a namespace where automatic injection is not enabled. Use istioctl kube-inject to manually inject the sidecar into the deployment manifest.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Create namespace WITHOUT injection label</span>
kubectl create namespace manual-inject
kubectl get namespace manual-inject --show-labels</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a deployment YAML file for nginx</li>
                            <li><strong>Task 2:</strong> Use <code>istioctl kube-inject</code> to inject the sidecar</li>
                            <li><strong>Task 3:</strong> Apply the injected manifest</li>
                            <li><strong>Task 4:</strong> Verify pod has 2 containers despite no namespace injection</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create deployment manifest</span>
cat &lt;&lt;EOF > nginx-deploy.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-manual
  namespace: manual-inject
spec:
  replicas: 1
  selector:
    matchLabels:
      app: nginx-manual
  template:
    metadata:
      labels:
        app: nginx-manual
    spec:
      containers:
      - name: nginx
        image: nginx:1.24
        ports:
        - containerPort: 80
EOF

<span class="comment"># Task 2: Inject sidecar</span>
istioctl kube-inject -f nginx-deploy.yaml > nginx-deploy-injected.yaml

<span class="comment"># Task 3: Apply injected manifest</span>
kubectl apply -f nginx-deploy-injected.yaml
kubectl wait --for=condition=ready pod -l app=nginx-manual -n manual-inject --timeout=120s

<span class="comment"># Task 4: Verify sidecar</span>
kubectl get pods -n manual-inject
kubectl get pod -l app=nginx-manual -n manual-inject -o jsonpath='{.items[0].spec.containers[*].name}'
echo ""

<span class="comment"># Verify proxy sync</span>
istioctl proxy-status | grep nginx-manual</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p>One-liner alternative: <code>kubectl apply -f &lt;(istioctl kube-inject -f deploy.yaml)</code></p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>Namespace has NO <code>istio-injection</code> label</li>
                                <li>Pod shows <code>2/2</code> READY</li>
                                <li>Containers: <code>nginx istio-proxy</code></li>
                                <li>proxy-status shows SYNCED</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace manual-inject
rm -f nginx-deploy.yaml nginx-deploy-injected.yaml</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/setup/additional-setup/sidecar-injection/#manual-sidecar-injection" target="_blank" class="ref-link">üìñ Manual Sidecar Injection</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 7 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">7</div>
                    <div class="question-content">
                        <div class="question-title">Configure Sidecar Proxy Resource Limits</div>
                        <div class="question-description">Configure default CPU and memory limits for sidecar proxies: requests 100m CPU/128Mi memory, limits 500m CPU/256Mi memory.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace resource-test
kubectl label namespace resource-test istio-injection=enabled</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Configure proxy resource requests: 100m CPU, 128Mi memory</li>
                            <li><strong>Task 2:</strong> Configure proxy resource limits: 500m CPU, 256Mi memory</li>
                            <li><strong>Task 3:</strong> Deploy test pod and verify resources</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1 & 2: Configure proxy resources</span>
istioctl install \
  --set values.global.proxy.resources.requests.cpu=100m \
  --set values.global.proxy.resources.requests.memory=128Mi \
  --set values.global.proxy.resources.limits.cpu=500m \
  --set values.global.proxy.resources.limits.memory=256Mi \
  -y

<span class="comment"># Task 3: Deploy test pod</span>
kubectl run resource-check --image=nginx:1.24 -n resource-test
kubectl wait --for=condition=ready pod/resource-check -n resource-test --timeout=120s

<span class="comment"># Verify resources</span>
kubectl get pod resource-check -n resource-test -o jsonpath='{.spec.containers[?(@.name=="istio-proxy")].resources}' | jq .</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p>Per-pod override via annotations: <code>sidecar.istio.io/proxyCPU</code>, <code>sidecar.istio.io/proxyMemory</code></p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>istio-proxy requests: cpu=100m, memory=128Mi</li>
                                <li>istio-proxy limits: cpu=500m, memory=256Mi</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace resource-test
istioctl install --set profile=default -y</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#ProxyConfig" target="_blank" class="ref-link">üìñ ProxyConfig Reference</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 8 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">8</div>
                    <div class="question-content">
                        <div class="question-title">Register External Service Using ServiceEntry</div>
                        <div class="question-description">With REGISTRY_ONLY mode enabled, create a ServiceEntry to allow mesh workloads to access httpbin.org external API.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Set REGISTRY_ONLY and deploy test client</span>
istioctl install --set meshConfig.outboundTrafficPolicy.mode=REGISTRY_ONLY -y

kubectl create namespace external-test
kubectl label namespace external-test istio-injection=enabled
kubectl apply -n external-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml
kubectl wait --for=condition=ready pod -l app=sleep -n external-test --timeout=120s

<span class="comment"># Verify blocked</span>
kubectl exec -n external-test deploy/sleep -- curl -sI https://httpbin.org/get --max-time 5 2>&1 | head -2 || echo "Blocked"</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create ServiceEntry <code>httpbin-ext</code> for httpbin.org (HTTPS/443)</li>
                            <li><strong>Task 2:</strong> Verify external access now works</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create ServiceEntry</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: ServiceEntry
metadata:
  name: httpbin-ext
  namespace: external-test
spec:
  hosts:
  - httpbin.org
  ports:
  - number: 443
    name: https
    protocol: TLS
  resolution: DNS
  location: MESH_EXTERNAL
EOF

<span class="comment"># Verify ServiceEntry</span>
kubectl get serviceentry -n external-test

<span class="comment"># Task 2: Test access</span>
kubectl exec -n external-test deploy/sleep -- curl -sI https://httpbin.org/get --max-time 10 | head -2</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p>ServiceEntry key fields: <code>hosts</code>, <code>ports</code>, <code>resolution: DNS</code>, <code>location: MESH_EXTERNAL</code></p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>ServiceEntry <code>httpbin-ext</code> created</li>
                                <li>curl returns <code>HTTP/2 200</code></li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace external-test
istioctl install --set meshConfig.outboundTrafficPolicy.mode=ALLOW_ANY -y</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/config/networking/service-entry/" target="_blank" class="ref-link">üìñ ServiceEntry Reference</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 9 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">9</div>
                    <div class="question-content">
                        <div class="question-title">Configure Application to Wait for Sidecar Proxy</div>
                        <div class="question-description">Enable holdApplicationUntilProxyStarts to ensure application containers wait for the Envoy sidecar to be ready before starting.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace proxy-wait
kubectl label namespace proxy-wait istio-injection=enabled</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Enable <code>holdApplicationUntilProxyStarts: true</code> globally</li>
                            <li><strong>Task 2:</strong> Deploy a test pod and verify the setting</li>
                            <li><strong>Task 3:</strong> (Alternative) Show per-pod annotation method</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Enable globally</span>
istioctl install --set meshConfig.defaultConfig.holdApplicationUntilProxyStarts=true -y

<span class="comment"># Verify</span>
kubectl get configmap istio -n istio-system -o jsonpath='{.data.mesh}' | grep holdApplication

<span class="comment"># Task 2: Deploy test pod</span>
kubectl run wait-test --image=nginx:1.24 -n proxy-wait
kubectl wait --for=condition=ready pod/wait-test -n proxy-wait --timeout=120s
kubectl get pods -n proxy-wait

<span class="comment"># Task 3: Per-pod annotation alternative</span>
cat &lt;&lt;EOF | kubectl apply -f -
apiVersion: v1
kind: Pod
metadata:
  name: wait-annotation
  namespace: proxy-wait
  annotations:
    proxy.istio.io/config: '{"holdApplicationUntilProxyStarts": true}'
spec:
  containers:
  - name: app
    image: nginx:1.24
EOF</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p>Global: <code>meshConfig.defaultConfig.holdApplicationUntilProxyStarts</code><br>
                            Per-pod: <code>proxy.istio.io/config</code> annotation</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>ConfigMap shows <code>holdApplicationUntilProxyStarts: true</code></li>
                                <li>Pods start successfully with <code>2/2</code> READY</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace proxy-wait
istioctl install --set profile=default -y</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#ProxyConfig" target="_blank" class="ref-link">üìñ ProxyConfig</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 10 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">10</div>
                    <div class="question-content">
                        <div class="question-title">Limit Sidecar Proxy Scope with Sidecar Resource</div>
                        <div class="question-description">Create a Sidecar resource to limit a namespace's proxy configuration to only the services it needs, reducing memory usage.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Create frontend and backend namespaces</span>
kubectl create namespace frontend
kubectl label namespace frontend istio-injection=enabled

kubectl create namespace backend
kubectl label namespace backend istio-injection=enabled

<span class="comment"># Deploy backend service</span>
kubectl create deployment backend-api --image=nginx:1.24 -n backend
kubectl expose deployment backend-api --port=80 -n backend
kubectl wait --for=condition=ready pod -l app=backend-api -n backend --timeout=120s

<span class="comment"># Deploy frontend client</span>
kubectl apply -n frontend -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml
kubectl wait --for=condition=ready pod -l app=sleep -n frontend --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Check current proxy cluster configuration</li>
                            <li><strong>Task 2:</strong> Create Sidecar resource limiting egress to <code>backend</code> and <code>istio-system</code> only</li>
                            <li><strong>Task 3:</strong> Verify reduced proxy config scope</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Check current clusters</span>
SLEEP_POD=$(kubectl get pod -l app=sleep -n frontend -o jsonpath='{.items[0].metadata.name}')
istioctl proxy-config clusters $SLEEP_POD -n frontend | head -15

<span class="comment"># Task 2: Create Sidecar resource</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: Sidecar
metadata:
  name: frontend-sidecar
  namespace: frontend
spec:
  egress:
  - hosts:
    - "./*"
    - "backend/*"
    - "istio-system/*"
EOF

sleep 5

<span class="comment"># Task 3: Verify reduced scope</span>
istioctl proxy-config clusters $SLEEP_POD -n frontend | head -15

<span class="comment"># Test connectivity still works</span>
kubectl exec -n frontend deploy/sleep -- curl -s backend-api.backend:80 | head -3</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p>Sidecar egress hosts: <code>./*</code> (same ns), <code>namespace/*</code> (specific ns). Always include <code>istio-system/*</code>.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>After Sidecar: proxy-config shows only frontend, backend, istio-system clusters</li>
                                <li>Connectivity to backend-api still works</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace frontend backend</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/config/networking/sidecar/" target="_blank" class="ref-link">üìñ Sidecar Reference</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 11 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">11</div>
                    <div class="question-content">
                        <div class="question-title">Install Istio with Demo Profile</div>
                        <div class="question-description">Install Istio using the demo profile for a training environment. Verify all components including egress gateway are deployed.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl cluster-info
kubectl get pods -n istio-system</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Install Istio with <code>demo</code> profile</li>
                            <li><strong>Task 2:</strong> Verify istiod, ingressgateway, and egressgateway are running</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Install demo profile</span>
istioctl install --set profile=demo -y

<span class="comment"># Task 2: Verify components</span>
kubectl get pods -n istio-system
kubectl get deployments -n istio-system

<span class="comment"># Verify specific components</span>
kubectl get deployment istiod -n istio-system
kubectl get deployment istio-ingressgateway -n istio-system
kubectl get deployment istio-egressgateway -n istio-system

istioctl version</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>demo</strong>: istiod + ingress + egress + high trace sampling<br>
                            <strong>default</strong>: istiod + ingress only (production)</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>istiod: READY 1/1</li>
                                <li>istio-ingressgateway: READY 1/1</li>
                                <li>istio-egressgateway: READY 1/1</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>istioctl install --set profile=default -y</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/setup/additional-setup/config-profiles/" target="_blank" class="ref-link">üìñ Configuration Profiles</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 12 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">12</div>
                    <div class="question-content">
                        <div class="question-title">Uninstall Istio Completely</div>
                        <div class="question-description">Remove Istio from the cluster completely, including all components, CRDs, and configuration.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Verify Istio is installed</span>
kubectl get pods -n istio-system
istioctl version</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Uninstall Istio using <code>istioctl uninstall --purge</code></li>
                            <li><strong>Task 2:</strong> Delete istio-system namespace</li>
                            <li><strong>Task 3:</strong> Remove Istio CRDs</li>
                            <li><strong>Task 4:</strong> Verify complete removal</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Uninstall Istio</span>
istioctl uninstall --purge -y

<span class="comment"># Task 2: Delete namespace</span>
kubectl delete namespace istio-system

<span class="comment"># Task 3: Remove CRDs</span>
kubectl get crd | grep istio.io | awk '{print $1}' | xargs kubectl delete crd

<span class="comment"># Task 4: Verify removal</span>
kubectl get namespace istio-system 2>/dev/null || echo "Namespace: REMOVED"
kubectl get crd | grep istio || echo "CRDs: REMOVED"
kubectl get mutatingwebhookconfiguration | grep istio || echo "Webhooks: REMOVED"</pre>
                        </div>

                        <div class="warning-box">
                            <h4>‚ö†Ô∏è Important</h4>
                            <p>Before production uninstall: remove injection labels, restart workloads to remove sidecars, backup configurations.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>istio-system namespace: does not exist</li>
                                <li>Istio CRDs: none remaining</li>
                                <li>Istio webhooks: none remaining</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <p class="narrative">Re-install Istio for subsequent exercises:</p>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>istioctl install --set profile=default -y
kubectl get pods -n istio-system</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/setup/install/istioctl/#uninstall-istio" target="_blank" class="ref-link">üìñ Uninstall Istio</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Domain 1 Complete Summary -->
            <div class="domain-summary install">
                <div class="domain-summary-header">
                    <div class="domain-summary-icon">‚öôÔ∏è</div>
                    <div class="domain-summary-title">Domain 1 Complete: Installation, Upgrade & Configuration</div>
                </div>
                <div class="domain-summary-grid">
                    <div class="domain-summary-item"><span class="q-num">Q1</span><span class="q-title">Verify Installation & Component Health</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q2</span><span class="q-title">Enable Access Logging (meshConfig)</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q3</span><span class="q-title">Namespace Sidecar Injection</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q4</span><span class="q-title">Exclude Pod from Injection</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q5</span><span class="q-title">Outbound Traffic Policy (REGISTRY_ONLY)</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q6</span><span class="q-title">Manual Injection (kube-inject)</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q7</span><span class="q-title">Proxy Resource Limits</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q8</span><span class="q-title">ServiceEntry for External Services</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q9</span><span class="q-title">holdApplicationUntilProxyStarts</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q10</span><span class="q-title">Sidecar Resource Scope</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q11</span><span class="q-title">Demo Profile Installation</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q12</span><span class="q-title">Uninstall Istio</span></div>
                </div>
            </div>

        </div>
    </section>

    <!-- Placeholder sections -->
    <section id="traffic" class="domain-section traffic">
        <div class="container">
            <div class="domain-header">
                <div class="domain-badge">Domain 2 ‚Ä¢ 35% of Exam ‚Ä¢ 12 Questions</div>
                <h2 class="domain-title">Traffic Management</h2>
                <p class="domain-description">Gateway, VirtualService, DestinationRule, traffic shifting, fault injection, and more.</p>
            </div>

            <!-- QUESTION 13 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">13</div>
                    <div class="question-content">
                        <div class="question-title">Expose Service via Istio Ingress Gateway</div>
                        <div class="question-description">Your team has deployed a web application that needs to be accessible from outside the cluster. Configure a Gateway and VirtualService to route external traffic to the application.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <p class="narrative">Deploy a sample application to expose via the ingress gateway.</p>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Create namespace</span>
kubectl create namespace webapp
kubectl label namespace webapp istio-injection=enabled

<span class="comment"># Deploy httpbin as sample app</span>
kubectl apply -n webapp -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl wait --for=condition=ready pod -l app=httpbin -n webapp --timeout=120s

<span class="comment"># Get ingress gateway IP</span>
kubectl get svc istio-ingressgateway -n istio-system</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a Gateway named <code>webapp-gateway</code> listening on port 80 for host <code>webapp.example.com</code></li>
                            <li><strong>Task 2:</strong> Create a VirtualService named <code>webapp-vs</code> that routes traffic from the gateway to the httpbin service</li>
                            <li><strong>Task 3:</strong> Test the configuration using curl with Host header</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create Gateway</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: Gateway
metadata:
  name: webapp-gateway
  namespace: webapp
spec:
  selector:
    istio: ingressgateway
  servers:
  - port:
      number: 80
      name: http
      protocol: HTTP
    hosts:
    - "webapp.example.com"
EOF

<span class="comment"># Task 2: Create VirtualService</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: webapp-vs
  namespace: webapp
spec:
  hosts:
  - "webapp.example.com"
  gateways:
  - webapp-gateway
  http:
  - route:
    - destination:
        host: httpbin
        port:
          number: 8000
EOF

<span class="comment"># Verify resources</span>
kubectl get gateway,virtualservice -n webapp

<span class="comment"># Task 3: Get ingress IP and test</span>
INGRESS_IP=$(kubectl get svc istio-ingressgateway -n istio-system -o jsonpath='{.status.loadBalancer.ingress[0].ip}')
<span class="comment"># If no external IP (e.g., minikube), use NodePort:</span>
[ -z "$INGRESS_IP" ] && INGRESS_IP=$(kubectl get nodes -o jsonpath='{.items[0].status.addresses[?(@.type=="InternalIP")].address}')
INGRESS_PORT=$(kubectl get svc istio-ingressgateway -n istio-system -o jsonpath='{.spec.ports[?(@.name=="http2")].nodePort}')

<span class="comment"># Test with Host header</span>
curl -s -H "Host: webapp.example.com" "http://${INGRESS_IP}:${INGRESS_PORT:-80}/headers" | head -20</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>Gateway</strong>: Configures the load balancer (ports, hosts, TLS)<br>
                            <strong>VirtualService</strong>: Defines routing rules (must reference the gateway)<br>
                            The <code>selector: istio: ingressgateway</code> binds to the default ingress gateway.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>Gateway <code>webapp-gateway</code> created</li>
                                <li>VirtualService <code>webapp-vs</code> created</li>
                                <li>curl returns httpbin response with headers</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace webapp</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/config/networking/gateway/" target="_blank" class="ref-link">üìñ Gateway Reference</a>
                            <a href="https://istio.io/latest/docs/reference/config/networking/virtual-service/" target="_blank" class="ref-link">üìñ VirtualService Reference</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 14 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">14</div>
                    <div class="question-content">
                        <div class="question-title">Configure Traffic Splitting for Canary Deployment</div>
                        <div class="question-description">You're rolling out a new version of a service. Configure traffic splitting to send 90% of traffic to v1 and 10% to v2 for canary testing.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <p class="narrative">Deploy two versions of a service with version labels.</p>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Create namespace</span>
kubectl create namespace canary-test
kubectl label namespace canary-test istio-injection=enabled

<span class="comment"># Deploy v1</span>
kubectl apply -n canary-test -f - &lt;&lt;EOF
apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp-v1
spec:
  replicas: 1
  selector:
    matchLabels:
      app: myapp
      version: v1
  template:
    metadata:
      labels:
        app: myapp
        version: v1
    spec:
      containers:
      - name: myapp
        image: hashicorp/http-echo
        args: ["-text=v1"]
        ports:
        - containerPort: 5678
EOF

<span class="comment"># Deploy v2</span>
kubectl apply -n canary-test -f - &lt;&lt;EOF
apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp-v2
spec:
  replicas: 1
  selector:
    matchLabels:
      app: myapp
      version: v2
  template:
    metadata:
      labels:
        app: myapp
        version: v2
    spec:
      containers:
      - name: myapp
        image: hashicorp/http-echo
        args: ["-text=v2"]
        ports:
        - containerPort: 5678
EOF

<span class="comment"># Create service (selects both versions)</span>
kubectl apply -n canary-test -f - &lt;&lt;EOF
apiVersion: v1
kind: Service
metadata:
  name: myapp
spec:
  selector:
    app: myapp
  ports:
  - port: 80
    targetPort: 5678
EOF

<span class="comment"># Deploy test client</span>
kubectl apply -n canary-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml
kubectl wait --for=condition=ready pod -l app=sleep -n canary-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a DestinationRule with subsets for v1 and v2</li>
                            <li><strong>Task 2:</strong> Create a VirtualService with 90/10 traffic split</li>
                            <li><strong>Task 3:</strong> Test and verify the traffic distribution</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create DestinationRule with subsets</span>
kubectl apply -n canary-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: DestinationRule
metadata:
  name: myapp-dr
spec:
  host: myapp
  subsets:
  - name: v1
    labels:
      version: v1
  - name: v2
    labels:
      version: v2
EOF

<span class="comment"># Task 2: Create VirtualService with 90/10 split</span>
kubectl apply -n canary-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: myapp-vs
spec:
  hosts:
  - myapp
  http:
  - route:
    - destination:
        host: myapp
        subset: v1
      weight: 90
    - destination:
        host: myapp
        subset: v2
      weight: 10
EOF

<span class="comment"># Verify resources</span>
kubectl get destinationrule,virtualservice -n canary-test

<span class="comment"># Task 3: Test traffic distribution (run 20 requests)</span>
echo "Testing traffic split (20 requests)..."
for i in {1..20}; do
  kubectl exec -n canary-test deploy/sleep -- curl -s myapp:80
done | sort | uniq -c</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>DestinationRule subsets</strong>: Define named groups of pods using labels<br>
                            <strong>VirtualService weight</strong>: Percentage of traffic (must sum to 100)<br>
                            Traffic split requires BOTH DestinationRule (subsets) AND VirtualService (weights).</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>DestinationRule with v1 and v2 subsets created</li>
                                <li>VirtualService with 90/10 weights created</li>
                                <li>~18 requests return "v1", ~2 requests return "v2"</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace canary-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/tasks/traffic-management/traffic-shifting/" target="_blank" class="ref-link">üìñ Traffic Shifting</a>
                            <a href="https://istio.io/latest/docs/reference/config/networking/destination-rule/" target="_blank" class="ref-link">üìñ DestinationRule Reference</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 15 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">15</div>
                    <div class="question-content">
                        <div class="question-title">Inject Fault Delay for Resilience Testing</div>
                        <div class="question-description">To test how your application handles slow dependencies, inject a 5-second delay into 50% of requests to a specific service.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Create namespace and deploy httpbin</span>
kubectl create namespace fault-test
kubectl label namespace fault-test istio-injection=enabled

kubectl apply -n fault-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n fault-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n fault-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n fault-test --timeout=120s

<span class="comment"># Test baseline response time</span>
echo "Baseline response time:"
kubectl exec -n fault-test deploy/sleep -- time curl -s httpbin:8000/get -o /dev/null</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a VirtualService that injects a 5s delay for 50% of requests to httpbin</li>
                            <li><strong>Task 2:</strong> Test multiple requests and observe the delayed responses</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create VirtualService with fault delay</span>
kubectl apply -n fault-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: httpbin-delay
spec:
  hosts:
  - httpbin
  http:
  - fault:
      delay:
        percentage:
          value: 50
        fixedDelay: 5s
    route:
    - destination:
        host: httpbin
        port:
          number: 8000
EOF

<span class="comment"># Verify</span>
kubectl get virtualservice -n fault-test

<span class="comment"># Task 2: Test multiple requests (observe ~50% with 5s delay)</span>
echo "Testing fault injection (5 requests)..."
for i in {1..5}; do
  echo "Request $i:"
  kubectl exec -n fault-test deploy/sleep -- sh -c 'time curl -s httpbin:8000/get -o /dev/null 2>&1 | grep real'
done</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>Fault delay</strong> simulates network latency or slow services.<br>
                            <code>fixedDelay</code>: Exact delay duration<br>
                            <code>percentage.value</code>: % of requests affected (0-100)</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>VirtualService with fault.delay created</li>
                                <li>~50% of requests take ~5 seconds</li>
                                <li>~50% of requests respond quickly (normal)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace fault-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/tasks/traffic-management/fault-injection/" target="_blank" class="ref-link">üìñ Fault Injection</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 16 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">16</div>
                    <div class="question-content">
                        <div class="question-title">Inject HTTP Abort Fault for Error Handling Testing</div>
                        <div class="question-description">Test your application's error handling by injecting HTTP 503 errors for 100% of requests to a specific endpoint.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace abort-test
kubectl label namespace abort-test istio-injection=enabled

kubectl apply -n abort-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n abort-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n abort-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n abort-test --timeout=120s

<span class="comment"># Verify baseline works</span>
kubectl exec -n abort-test deploy/sleep -- curl -sI httpbin:8000/status/200 | head -1</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a VirtualService that returns HTTP 503 for 100% of requests</li>
                            <li><strong>Task 2:</strong> Test and verify all requests receive 503 errors</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create VirtualService with abort fault</span>
kubectl apply -n abort-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: httpbin-abort
spec:
  hosts:
  - httpbin
  http:
  - fault:
      abort:
        percentage:
          value: 100
        httpStatus: 503
    route:
    - destination:
        host: httpbin
        port:
          number: 8000
EOF

<span class="comment"># Task 2: Test (all requests should return 503)</span>
echo "Testing abort fault injection..."
for i in {1..3}; do
  kubectl exec -n abort-test deploy/sleep -- curl -sI httpbin:8000/get | head -1
done</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>fault.abort</strong> returns an error without calling the service.<br>
                            Common test codes: 400, 403, 404, 500, 502, 503<br>
                            Use for testing circuit breakers and retry logic.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>VirtualService with fault.abort created</li>
                                <li>All requests return <code>HTTP/1.1 503 Service Unavailable</code></li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace abort-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/tasks/traffic-management/fault-injection/#injecting-an-http-abort-fault" target="_blank" class="ref-link">üìñ HTTP Abort Fault</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 17 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">17</div>
                    <div class="question-content">
                        <div class="question-title">Configure Request Timeout</div>
                        <div class="question-description">Prevent requests from hanging indefinitely by configuring a 3-second timeout for a service. Requests exceeding this duration should be terminated.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace timeout-test
kubectl label namespace timeout-test istio-injection=enabled

kubectl apply -n timeout-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n timeout-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n timeout-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n timeout-test --timeout=120s

<span class="comment"># Test slow endpoint (5s delay) - should work without timeout</span>
echo "Testing 5s delay endpoint (no timeout configured):"
kubectl exec -n timeout-test deploy/sleep -- curl -s httpbin:8000/delay/5 -o /dev/null -w "Status: %{http_code}, Time: %{time_total}s\n"</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a VirtualService with a 3-second timeout for httpbin</li>
                            <li><strong>Task 2:</strong> Test with a request that takes 5 seconds (should timeout)</li>
                            <li><strong>Task 3:</strong> Test with a fast request (should succeed)</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create VirtualService with 3s timeout</span>
kubectl apply -n timeout-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: httpbin-timeout
spec:
  hosts:
  - httpbin
  http:
  - timeout: 3s
    route:
    - destination:
        host: httpbin
        port:
          number: 8000
EOF

<span class="comment"># Task 2: Test slow endpoint (5s) - should timeout after 3s</span>
echo "Testing 5s delay with 3s timeout (should fail):"
kubectl exec -n timeout-test deploy/sleep -- curl -s httpbin:8000/delay/5 -o /dev/null -w "Status: %{http_code}, Time: %{time_total}s\n"

<span class="comment"># Task 3: Test fast endpoint - should succeed</span>
echo "Testing fast endpoint (should succeed):"
kubectl exec -n timeout-test deploy/sleep -- curl -s httpbin:8000/get -o /dev/null -w "Status: %{http_code}, Time: %{time_total}s\n"</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><code>timeout</code> applies to the entire request duration.<br>
                            Timed-out requests return <code>504 Gateway Timeout</code>.<br>
                            Always set timeouts in production to prevent resource exhaustion.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>5s delay request returns <code>504</code> after ~3 seconds</li>
                                <li>Fast request returns <code>200</code> quickly</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace timeout-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/tasks/traffic-management/request-timeouts/" target="_blank" class="ref-link">üìñ Request Timeouts</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 18 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">18</div>
                    <div class="question-content">
                        <div class="question-title">Configure Automatic Retries</div>
                        <div class="question-description">Improve service reliability by configuring automatic retries. Set up 3 retry attempts for 5xx errors with a per-retry timeout.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace retry-test
kubectl label namespace retry-test istio-injection=enabled

kubectl apply -n retry-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n retry-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n retry-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n retry-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a VirtualService with retry policy: 3 attempts, 2s per-try timeout, retry on 5xx errors</li>
                            <li><strong>Task 2:</strong> Verify retry configuration</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create VirtualService with retries</span>
kubectl apply -n retry-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: httpbin-retry
spec:
  hosts:
  - httpbin
  http:
  - retries:
      attempts: 3
      perTryTimeout: 2s
      retryOn: 5xx,reset,connect-failure,retriable-4xx
    route:
    - destination:
        host: httpbin
        port:
          number: 8000
EOF

<span class="comment"># Verify configuration</span>
kubectl get virtualservice httpbin-retry -n retry-test -o yaml | grep -A5 retries

<span class="comment"># Task 2: Test with normal request</span>
kubectl exec -n retry-test deploy/sleep -- curl -s httpbin:8000/get | head -5

<span class="comment"># Test with 500 error endpoint (Istio will retry)</span>
echo "Testing 500 endpoint (retries will occur but still fail):"
kubectl exec -n retry-test deploy/sleep -- curl -sI httpbin:8000/status/500 | head -1</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><code>attempts</code>: Max retry count (not including original request)<br>
                            <code>perTryTimeout</code>: Timeout for each attempt<br>
                            <code>retryOn</code>: Conditions to trigger retry (5xx, reset, connect-failure, etc.)</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>VirtualService shows retry config with attempts: 3</li>
                                <li>Normal requests succeed</li>
                                <li>500 errors still fail (but retries were attempted)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace retry-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/concepts/traffic-management/#retries" target="_blank" class="ref-link">üìñ Retries</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 19 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">19</div>
                    <div class="question-content">
                        <div class="question-title">Configure Circuit Breaker with Connection Pool</div>
                        <div class="question-description">Protect your service from being overwhelmed by configuring circuit breaker settings. Limit concurrent connections and pending requests.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace circuit-test
kubectl label namespace circuit-test istio-injection=enabled

kubectl apply -n circuit-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n circuit-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n circuit-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n circuit-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a DestinationRule with circuit breaker: max 1 connection, max 1 pending request</li>
                            <li><strong>Task 2:</strong> Test by sending concurrent requests to trigger the circuit breaker</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create DestinationRule with circuit breaker</span>
kubectl apply -n circuit-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: DestinationRule
metadata:
  name: httpbin-cb
spec:
  host: httpbin
  trafficPolicy:
    connectionPool:
      tcp:
        maxConnections: 1
      http:
        http1MaxPendingRequests: 1
        http2MaxRequests: 1
        maxRequestsPerConnection: 1
    outlierDetection:
      consecutive5xxErrors: 3
      interval: 30s
      baseEjectionTime: 30s
      maxEjectionPercent: 100
EOF

<span class="comment"># Verify configuration</span>
kubectl get destinationrule httpbin-cb -n circuit-test -o yaml | grep -A10 connectionPool

<span class="comment"># Task 2: Test with concurrent requests (using fortio if available, or simple loop)</span>
echo "Testing circuit breaker with rapid requests..."
for i in {1..10}; do
  kubectl exec -n circuit-test deploy/sleep -- curl -s httpbin:8000/get -o /dev/null -w "%{http_code}\n" &
done
wait</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>connectionPool</strong>: Limits connections and requests<br>
                            <strong>outlierDetection</strong>: Ejects unhealthy hosts (true circuit breaker)<br>
                            When limits exceeded: <code>503</code> with flag <code>UO</code> (upstream overflow)</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>DestinationRule with connectionPool settings created</li>
                                <li>Some requests return <code>503</code> when circuit breaker trips</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace circuit-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/tasks/traffic-management/circuit-breaking/" target="_blank" class="ref-link">üìñ Circuit Breaking</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 20 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">20</div>
                    <div class="question-content">
                        <div class="question-title">Configure Traffic Mirroring</div>
                        <div class="question-description">Test a new version of your service with production traffic without impacting users. Mirror 100% of traffic from v1 to v2 while users only see v1 responses.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace mirror-test
kubectl label namespace mirror-test istio-injection=enabled

<span class="comment"># Deploy v1 and v2 httpbin instances</span>
kubectl apply -n mirror-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml

<span class="comment"># Create v2 deployment</span>
kubectl apply -n mirror-test -f - &lt;&lt;EOF
apiVersion: apps/v1
kind: Deployment
metadata:
  name: httpbin-v2
spec:
  replicas: 1
  selector:
    matchLabels:
      app: httpbin
      version: v2
  template:
    metadata:
      labels:
        app: httpbin
        version: v2
    spec:
      containers:
      - name: httpbin
        image: docker.io/kong/httpbin
        ports:
        - containerPort: 80
EOF

<span class="comment"># Label original deployment as v1</span>
kubectl patch deployment httpbin -n mirror-test --type merge -p '{"spec":{"template":{"metadata":{"labels":{"version":"v1"}}}}}'

kubectl apply -n mirror-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml
kubectl wait --for=condition=ready pod -l app=httpbin -n mirror-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n mirror-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create DestinationRule with v1 and v2 subsets</li>
                            <li><strong>Task 2:</strong> Create VirtualService that routes to v1 and mirrors to v2</li>
                            <li><strong>Task 3:</strong> Generate traffic and verify mirroring in v2 logs</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create DestinationRule</span>
kubectl apply -n mirror-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: DestinationRule
metadata:
  name: httpbin-dr
spec:
  host: httpbin
  subsets:
  - name: v1
    labels:
      version: v1
  - name: v2
    labels:
      version: v2
EOF

<span class="comment"># Task 2: Create VirtualService with mirroring</span>
kubectl apply -n mirror-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: httpbin-mirror
spec:
  hosts:
  - httpbin
  http:
  - route:
    - destination:
        host: httpbin
        subset: v1
    mirror:
      host: httpbin
      subset: v2
    mirrorPercentage:
      value: 100
EOF

<span class="comment"># Task 3: Generate traffic</span>
echo "Generating traffic..."
for i in {1..5}; do
  kubectl exec -n mirror-test deploy/sleep -- curl -s httpbin:8000/headers -o /dev/null
done

<span class="comment"># Check v2 logs for mirrored requests</span>
echo "Checking v2 logs for mirrored traffic:"
kubectl logs -n mirror-test deploy/httpbin-v2 --tail=10</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><code>mirror</code>: Destination for mirrored traffic<br>
                            <code>mirrorPercentage</code>: % of traffic to mirror (default 100%)<br>
                            Mirrored requests are fire-and-forget (responses ignored).</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>VirtualService with mirror configuration created</li>
                                <li>Users get responses from v1 only</li>
                                <li>v2 logs show incoming mirrored requests</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace mirror-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/tasks/traffic-management/mirroring/" target="_blank" class="ref-link">üìñ Traffic Mirroring</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 21 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">21</div>
                    <div class="question-content">
                        <div class="question-title">Route Traffic Based on HTTP Headers</div>
                        <div class="question-description">Implement header-based routing to direct requests with a specific header to a different version. Route requests with header <code>x-user-type: premium</code> to v2, all others to v1.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace header-test
kubectl label namespace header-test istio-injection=enabled

<span class="comment"># Deploy two versions</span>
kubectl apply -n header-test -f - &lt;&lt;EOF
apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp-v1
spec:
  replicas: 1
  selector:
    matchLabels:
      app: myapp
      version: v1
  template:
    metadata:
      labels:
        app: myapp
        version: v1
    spec:
      containers:
      - name: app
        image: hashicorp/http-echo
        args: ["-text=v1-standard"]
        ports:
        - containerPort: 5678
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp-v2
spec:
  replicas: 1
  selector:
    matchLabels:
      app: myapp
      version: v2
  template:
    metadata:
      labels:
        app: myapp
        version: v2
    spec:
      containers:
      - name: app
        image: hashicorp/http-echo
        args: ["-text=v2-premium"]
        ports:
        - containerPort: 5678
---
apiVersion: v1
kind: Service
metadata:
  name: myapp
spec:
  selector:
    app: myapp
  ports:
  - port: 80
    targetPort: 5678
EOF

kubectl apply -n header-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml
kubectl wait --for=condition=ready pod -l app=myapp -n header-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n header-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create DestinationRule with v1 and v2 subsets</li>
                            <li><strong>Task 2:</strong> Create VirtualService with header-based match: <code>x-user-type: premium</code> ‚Üí v2, default ‚Üí v1</li>
                            <li><strong>Task 3:</strong> Test with and without the header</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create DestinationRule</span>
kubectl apply -n header-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: DestinationRule
metadata:
  name: myapp-dr
spec:
  host: myapp
  subsets:
  - name: v1
    labels:
      version: v1
  - name: v2
    labels:
      version: v2
EOF

<span class="comment"># Task 2: Create VirtualService with header match</span>
kubectl apply -n header-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: myapp-vs
spec:
  hosts:
  - myapp
  http:
  - match:
    - headers:
        x-user-type:
          exact: premium
    route:
    - destination:
        host: myapp
        subset: v2
  - route:
    - destination:
        host: myapp
        subset: v1
EOF

<span class="comment"># Task 3: Test routing</span>
echo "Request WITHOUT header (should get v1):"
kubectl exec -n header-test deploy/sleep -- curl -s myapp:80

echo ""
echo "Request WITH premium header (should get v2):"
kubectl exec -n header-test deploy/sleep -- curl -s -H "x-user-type: premium" myapp:80</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p>Header match types: <code>exact</code>, <code>prefix</code>, <code>regex</code><br>
                            Match rules are evaluated in order - first match wins.<br>
                            Always have a default route at the end (no match condition).</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>Request without header returns: <code>v1-standard</code></li>
                                <li>Request with <code>x-user-type: premium</code> returns: <code>v2-premium</code></li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace header-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/tasks/traffic-management/request-routing/" target="_blank" class="ref-link">üìñ Request Routing</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 22 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">22</div>
                    <div class="question-content">
                        <div class="question-title">Route Traffic Based on URI Path</div>
                        <div class="question-description">Route requests to different services based on the URI path. Send <code>/api/v1/*</code> to service-v1 and <code>/api/v2/*</code> to service-v2.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace uri-test
kubectl label namespace uri-test istio-injection=enabled

<span class="comment"># Deploy httpbin as backend</span>
kubectl apply -n uri-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n uri-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n uri-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n uri-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a VirtualService with URI prefix matching</li>
                            <li><strong>Task 2:</strong> Configure path rewrite so <code>/api/v1/status</code> becomes <code>/status</code></li>
                            <li><strong>Task 3:</strong> Test the URI-based routing</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1 & 2: Create VirtualService with URI match and rewrite</span>
kubectl apply -n uri-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: httpbin-uri
spec:
  hosts:
  - httpbin
  http:
  - match:
    - uri:
        prefix: /api/v1/
    rewrite:
      uri: /
    route:
    - destination:
        host: httpbin
        port:
          number: 8000
  - match:
    - uri:
        prefix: /api/v2/
    rewrite:
      uri: /
    route:
    - destination:
        host: httpbin
        port:
          number: 8000
  - route:
    - destination:
        host: httpbin
        port:
          number: 8000
EOF

<span class="comment"># Task 3: Test URI routing</span>
echo "Testing /api/v1/get (rewrites to /get):"
kubectl exec -n uri-test deploy/sleep -- curl -s httpbin:8000/api/v1/get | head -5

echo ""
echo "Testing /api/v2/headers (rewrites to /headers):"
kubectl exec -n uri-test deploy/sleep -- curl -s httpbin:8000/api/v2/headers | head -5

echo ""
echo "Testing /get directly:"
kubectl exec -n uri-test deploy/sleep -- curl -s httpbin:8000/get | head -5</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p>URI match types: <code>exact</code>, <code>prefix</code>, <code>regex</code><br>
                            <code>rewrite.uri</code>: Replace matched path before sending to destination<br>
                            Prefix <code>/api/v1/</code> with rewrite <code>/</code> maps <code>/api/v1/get</code> ‚Üí <code>/get</code></p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li><code>/api/v1/get</code> returns httpbin /get response</li>
                                <li><code>/api/v2/headers</code> returns httpbin /headers response</li>
                                <li>Path rewriting works correctly</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace uri-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/config/networking/virtual-service/#HTTPMatchRequest" target="_blank" class="ref-link">üìñ HTTPMatchRequest</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 23 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">23</div>
                    <div class="question-content">
                        <div class="question-title">Configure Load Balancing Algorithm</div>
                        <div class="question-description">Change the default load balancing algorithm from round-robin to least connections for a service that has varying request processing times.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace lb-test
kubectl label namespace lb-test istio-injection=enabled

kubectl apply -n lb-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n lb-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n lb-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n lb-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a DestinationRule with <code>LEAST_REQUEST</code> load balancing</li>
                            <li><strong>Task 2:</strong> Verify the configuration</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create DestinationRule with load balancing</span>
kubectl apply -n lb-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: DestinationRule
metadata:
  name: httpbin-lb
spec:
  host: httpbin
  trafficPolicy:
    loadBalancer:
      simple: LEAST_REQUEST
EOF

<span class="comment"># Task 2: Verify configuration</span>
kubectl get destinationrule httpbin-lb -n lb-test -o yaml | grep -A3 loadBalancer

<span class="comment"># Test requests</span>
for i in {1..5}; do
  kubectl exec -n lb-test deploy/sleep -- curl -s httpbin:8000/get -o /dev/null -w "Request $i: %{http_code}\n"
done</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p>Load balancing algorithms:<br>
                            ‚Ä¢ <code>ROUND_ROBIN</code> (default): Rotate through endpoints<br>
                            ‚Ä¢ <code>LEAST_REQUEST</code>: Send to endpoint with fewest active requests<br>
                            ‚Ä¢ <code>RANDOM</code>: Random endpoint selection<br>
                            ‚Ä¢ <code>PASSTHROUGH</code>: Direct connection (no load balancing)</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>DestinationRule shows <code>simple: LEAST_REQUEST</code></li>
                                <li>All requests return <code>200</code></li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace lb-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/config/networking/destination-rule/#LoadBalancerSettings" target="_blank" class="ref-link">üìñ LoadBalancerSettings</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 24 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">24</div>
                    <div class="question-content">
                        <div class="question-title">Configure Sticky Sessions with Consistent Hashing</div>
                        <div class="question-description">For a stateful application, configure session affinity so requests from the same user always go to the same backend pod using consistent hash based on a header.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace sticky-test
kubectl label namespace sticky-test istio-injection=enabled

<span class="comment"># Deploy multiple replicas</span>
kubectl apply -n sticky-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl scale deployment httpbin -n sticky-test --replicas=3

kubectl apply -n sticky-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n sticky-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n sticky-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create DestinationRule with consistent hash based on <code>x-user-id</code> header</li>
                            <li><strong>Task 2:</strong> Test that same user-id always routes to same pod</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create DestinationRule with consistent hash</span>
kubectl apply -n sticky-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: DestinationRule
metadata:
  name: httpbin-sticky
spec:
  host: httpbin
  trafficPolicy:
    loadBalancer:
      consistentHash:
        httpHeaderName: x-user-id
EOF

<span class="comment"># Task 2: Test sticky sessions</span>
echo "Requests with x-user-id: user-123 (should hit same pod):"
for i in {1..3}; do
  kubectl exec -n sticky-test deploy/sleep -- curl -s -H "x-user-id: user-123" httpbin:8000/headers | grep -i "pod\|host"
done

echo ""
echo "Requests with x-user-id: user-456 (may hit different pod):"
for i in {1..3}; do
  kubectl exec -n sticky-test deploy/sleep -- curl -s -H "x-user-id: user-456" httpbin:8000/headers | grep -i "pod\|host"
done</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p>Consistent hash options:<br>
                            ‚Ä¢ <code>httpHeaderName</code>: Hash based on header value<br>
                            ‚Ä¢ <code>httpCookie</code>: Hash based on cookie<br>
                            ‚Ä¢ <code>useSourceIp</code>: Hash based on client IP<br>
                            ‚Ä¢ <code>httpQueryParameterName</code>: Hash based on query param</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>Same x-user-id consistently routes to same backend</li>
                                <li>Different user-ids may route to different backends</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace sticky-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/config/networking/destination-rule/#LoadBalancerSettings-ConsistentHashLB" target="_blank" class="ref-link">üìñ ConsistentHashLB</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Domain 2 Complete Summary -->
            <div class="domain-summary traffic">
                <div class="domain-summary-header">
                    <div class="domain-summary-icon">üîÄ</div>
                    <div class="domain-summary-title">Domain 2 Complete: Traffic Management</div>
                </div>
                <div class="domain-summary-grid">
                    <div class="domain-summary-item"><span class="q-num">Q13</span><span class="q-title">Gateway & VirtualService for Ingress</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q14</span><span class="q-title">Traffic Splitting (Canary)</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q15</span><span class="q-title">Fault Injection - Delay</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q16</span><span class="q-title">Fault Injection - Abort</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q17</span><span class="q-title">Request Timeout</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q18</span><span class="q-title">Automatic Retries</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q19</span><span class="q-title">Circuit Breaker</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q20</span><span class="q-title">Traffic Mirroring</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q21</span><span class="q-title">Header-Based Routing</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q22</span><span class="q-title">URI Path Routing & Rewrite</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q23</span><span class="q-title">Load Balancing Algorithm</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q24</span><span class="q-title">Sticky Sessions (Consistent Hash)</span></div>
                </div>
            </div>

        </div>
    </section>

    <section id="security" class="domain-section security">
        <div class="container">
            <div class="domain-header">
                <div class="domain-badge">Domain 3 ‚Ä¢ 20% of Exam ‚Ä¢ 12 Questions</div>
                <h2 class="domain-title">Securing Workloads</h2>
                <p class="domain-description">mTLS, PeerAuthentication, AuthorizationPolicy, JWT, Gateway TLS.</p>
            </div>

            <!-- QUESTION 25 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">25</div>
                    <div class="question-content">
                        <div class="question-title">Enable Strict mTLS for a Namespace</div>
                        <div class="question-description">Your security team requires all traffic within the payments namespace to be encrypted. Configure strict mutual TLS to reject any plaintext traffic.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Create namespace with sidecar injection</span>
kubectl create namespace payments
kubectl label namespace payments istio-injection=enabled

<span class="comment"># Deploy test services</span>
kubectl apply -n payments -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n payments -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n payments --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n payments --timeout=120s

<span class="comment"># Create a non-mesh client (no sidecar) in default namespace</span>
kubectl run curl-no-mesh --image=curlimages/curl --command -- sleep 3600
kubectl wait --for=condition=ready pod/curl-no-mesh --timeout=60s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a PeerAuthentication policy named <code>payments-strict</code> that enforces STRICT mTLS for the payments namespace</li>
                            <li><strong>Task 2:</strong> Verify mesh clients (with sidecar) can still communicate</li>
                            <li><strong>Task 3:</strong> Verify non-mesh clients (without sidecar) are rejected</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create PeerAuthentication with STRICT mTLS</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: security.istio.io/v1
kind: PeerAuthentication
metadata:
  name: payments-strict
  namespace: payments
spec:
  mtls:
    mode: STRICT
EOF

<span class="comment"># Verify PeerAuthentication</span>
kubectl get peerauthentication -n payments

<span class="comment"># Task 2: Test from mesh client (should succeed)</span>
echo "Testing from mesh client (with sidecar):"
kubectl exec -n payments deploy/sleep -- curl -s httpbin:8000/get -o /dev/null -w "%{http_code}\n"

<span class="comment"># Task 3: Test from non-mesh client (should fail)</span>
echo "Testing from non-mesh client (no sidecar):"
kubectl exec curl-no-mesh -- curl -s httpbin.payments:8000/get --max-time 5 -o /dev/null -w "%{http_code}\n" 2>&1 || echo "Connection rejected (expected)"</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>mTLS modes:</strong><br>
                            ‚Ä¢ <code>PERMISSIVE</code> (default): Accept both mTLS and plaintext<br>
                            ‚Ä¢ <code>STRICT</code>: Only accept mTLS connections<br>
                            ‚Ä¢ <code>DISABLE</code>: Only accept plaintext<br>
                            ‚Ä¢ <code>UNSET</code>: Inherit from parent scope</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>PeerAuthentication <code>payments-strict</code> created with mode: STRICT</li>
                                <li>Mesh client returns <code>200</code></li>
                                <li>Non-mesh client connection fails/times out</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace payments
kubectl delete pod curl-no-mesh</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/config/security/peer_authentication/" target="_blank" class="ref-link">üìñ PeerAuthentication</a>
                            <a href="https://istio.io/latest/docs/concepts/security/#mutual-tls-authentication" target="_blank" class="ref-link">üìñ Mutual TLS</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 26 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">26</div>
                    <div class="question-content">
                        <div class="question-title">Enable Mesh-Wide Strict mTLS</div>
                        <div class="question-description">Implement a zero-trust security model by enabling strict mTLS across the entire service mesh. All services must communicate using mutual TLS.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Create test namespaces</span>
kubectl create namespace app-a
kubectl create namespace app-b
kubectl label namespace app-a istio-injection=enabled
kubectl label namespace app-b istio-injection=enabled

<span class="comment"># Deploy test services</span>
kubectl apply -n app-a -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml
kubectl apply -n app-b -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml

kubectl wait --for=condition=ready pod -l app=sleep -n app-a --timeout=120s
kubectl wait --for=condition=ready pod -l app=httpbin -n app-b --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a mesh-wide PeerAuthentication policy in <code>istio-system</code> namespace</li>
                            <li><strong>Task 2:</strong> Verify cross-namespace communication still works with mTLS</li>
                            <li><strong>Task 3:</strong> Check the mTLS status using istioctl</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create mesh-wide PeerAuthentication</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: security.istio.io/v1
kind: PeerAuthentication
metadata:
  name: default
  namespace: istio-system
spec:
  mtls:
    mode: STRICT
EOF

<span class="comment"># Verify</span>
kubectl get peerauthentication -n istio-system

<span class="comment"># Task 2: Test cross-namespace communication</span>
echo "Testing cross-namespace communication:"
kubectl exec -n app-a deploy/sleep -- curl -s httpbin.app-b:8000/get -o /dev/null -w "%{http_code}\n"

<span class="comment"># Task 3: Check mTLS status</span>
echo "Checking mTLS status:"
istioctl x describe pod $(kubectl get pod -n app-b -l app=httpbin -o jsonpath='{.items[0].metadata.name}') -n app-b | grep -i tls</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p>Mesh-wide policy must be in <code>istio-system</code> namespace with name <code>default</code>.<br>
                            Hierarchy: Workload > Namespace > Mesh-wide<br>
                            More specific policies override broader ones.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>PeerAuthentication in istio-system with name <code>default</code></li>
                                <li>Cross-namespace request returns <code>200</code></li>
                                <li>istioctl shows mTLS is enforced</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete peerauthentication default -n istio-system
kubectl delete namespace app-a app-b</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/tasks/security/authentication/mtls-migration/" target="_blank" class="ref-link">üìñ mTLS Migration</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 27 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">27</div>
                    <div class="question-content">
                        <div class="question-title">Disable mTLS for Specific Port</div>
                        <div class="question-description">A legacy health check system cannot use mTLS. Configure PeerAuthentication to use STRICT mTLS but disable it for the health check port 8080.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace port-mtls
kubectl label namespace port-mtls istio-injection=enabled

kubectl apply -n port-mtls -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n port-mtls -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n port-mtls --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n port-mtls --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create PeerAuthentication with STRICT mTLS but DISABLE for port 8080</li>
                            <li><strong>Task 2:</strong> Verify the port-level override configuration</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create PeerAuthentication with port exception</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: security.istio.io/v1
kind: PeerAuthentication
metadata:
  name: httpbin-port-exception
  namespace: port-mtls
spec:
  selector:
    matchLabels:
      app: httpbin
  mtls:
    mode: STRICT
  portLevelMtls:
    8080:
      mode: DISABLE
EOF

<span class="comment"># Task 2: Verify configuration</span>
kubectl get peerauthentication -n port-mtls -o yaml | grep -A5 portLevelMtls

<span class="comment"># Test main port (8000 - STRICT mTLS)</span>
echo "Testing port 8000 (STRICT mTLS):"
kubectl exec -n port-mtls deploy/sleep -- curl -s httpbin:8000/get -o /dev/null -w "%{http_code}\n"</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><code>portLevelMtls</code> allows different mTLS modes per port.<br>
                            Use cases: health checks, metrics endpoints, legacy integrations.<br>
                            The <code>selector</code> targets specific workloads.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>PeerAuthentication shows portLevelMtls with 8080: DISABLE</li>
                                <li>Main port communication works with mTLS</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace port-mtls</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/config/security/peer_authentication/#PeerAuthentication-MutualTLS" target="_blank" class="ref-link">üìñ Port-Level mTLS</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 28 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">28</div>
                    <div class="question-content">
                        <div class="question-title">Create DENY Authorization Policy</div>
                        <div class="question-description">Block all traffic to a sensitive service by default. Create an AuthorizationPolicy that denies all requests to the database service.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace authz-deny
kubectl label namespace authz-deny istio-injection=enabled

<span class="comment"># Deploy "database" service (using httpbin)</span>
kubectl apply -n authz-deny -f - &lt;&lt;EOF
apiVersion: apps/v1
kind: Deployment
metadata:
  name: database
spec:
  replicas: 1
  selector:
    matchLabels:
      app: database
  template:
    metadata:
      labels:
        app: database
    spec:
      containers:
      - name: database
        image: docker.io/kong/httpbin
        ports:
        - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: database
spec:
  selector:
    app: database
  ports:
  - port: 80
EOF

kubectl apply -n authz-deny -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml
kubectl wait --for=condition=ready pod -l app=database -n authz-deny --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n authz-deny --timeout=120s

<span class="comment"># Verify access works before policy</span>
echo "Before policy - should succeed:"
kubectl exec -n authz-deny deploy/sleep -- curl -s database/get -o /dev/null -w "%{http_code}\n"</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create an AuthorizationPolicy that denies ALL requests to the database service</li>
                            <li><strong>Task 2:</strong> Verify requests are now blocked with 403 Forbidden</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create DENY policy</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: security.istio.io/v1
kind: AuthorizationPolicy
metadata:
  name: deny-all-database
  namespace: authz-deny
spec:
  selector:
    matchLabels:
      app: database
  action: DENY
  rules:
  - {}
EOF

<span class="comment"># Task 2: Verify access is denied</span>
echo "After DENY policy - should return 403:"
kubectl exec -n authz-deny deploy/sleep -- curl -s database/get -o /dev/null -w "%{http_code}\n"</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><code>action: DENY</code> with empty rules <code>- {}</code> matches ALL requests.<br>
                            DENY policies are evaluated before ALLOW policies.<br>
                            Blocked requests return <code>403 Forbidden</code> with <code>RBAC: access denied</code>.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>AuthorizationPolicy with action: DENY created</li>
                                <li>Requests return <code>403</code> Forbidden</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace authz-deny</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/config/security/authorization-policy/" target="_blank" class="ref-link">üìñ AuthorizationPolicy</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 29 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">29</div>
                    <div class="question-content">
                        <div class="question-title">Create ALLOW Authorization Policy Based on Source</div>
                        <div class="question-description">Allow only specific services to access the backend API. Create an AuthorizationPolicy that only allows requests from the frontend service account.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace authz-allow
kubectl label namespace authz-allow istio-injection=enabled

<span class="comment"># Create service accounts</span>
kubectl create serviceaccount frontend -n authz-allow
kubectl create serviceaccount other -n authz-allow

<span class="comment"># Deploy backend API</span>
kubectl apply -n authz-allow -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml

<span class="comment"># Deploy frontend client (with frontend SA)</span>
kubectl apply -n authz-allow -f - &lt;&lt;EOF
apiVersion: apps/v1
kind: Deployment
metadata:
  name: frontend
spec:
  replicas: 1
  selector:
    matchLabels:
      app: frontend
  template:
    metadata:
      labels:
        app: frontend
    spec:
      serviceAccountName: frontend
      containers:
      - name: sleep
        image: curlimages/curl
        command: ["/bin/sleep", "3600"]
EOF

<span class="comment"># Deploy other client (with other SA)</span>
kubectl apply -n authz-allow -f - &lt;&lt;EOF
apiVersion: apps/v1
kind: Deployment
metadata:
  name: other-client
spec:
  replicas: 1
  selector:
    matchLabels:
      app: other-client
  template:
    metadata:
      labels:
        app: other-client
    spec:
      serviceAccountName: other
      containers:
      - name: sleep
        image: curlimages/curl
        command: ["/bin/sleep", "3600"]
EOF

kubectl wait --for=condition=ready pod -l app=httpbin -n authz-allow --timeout=120s
kubectl wait --for=condition=ready pod -l app=frontend -n authz-allow --timeout=120s
kubectl wait --for=condition=ready pod -l app=other-client -n authz-allow --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create AuthorizationPolicy allowing only <code>frontend</code> service account to access httpbin</li>
                            <li><strong>Task 2:</strong> Verify frontend can access httpbin</li>
                            <li><strong>Task 3:</strong> Verify other-client is denied</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create ALLOW policy for frontend SA</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: security.istio.io/v1
kind: AuthorizationPolicy
metadata:
  name: allow-frontend-only
  namespace: authz-allow
spec:
  selector:
    matchLabels:
      app: httpbin
  action: ALLOW
  rules:
  - from:
    - source:
        principals: ["cluster.local/ns/authz-allow/sa/frontend"]
EOF

<span class="comment"># Task 2: Test from frontend (should succeed)</span>
echo "Testing from frontend SA:"
kubectl exec -n authz-allow deploy/frontend -- curl -s httpbin:8000/get -o /dev/null -w "%{http_code}\n"

<span class="comment"># Task 3: Test from other-client (should fail)</span>
echo "Testing from other SA:"
kubectl exec -n authz-allow deploy/other-client -- curl -s httpbin:8000/get -o /dev/null -w "%{http_code}\n"</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p>Service account principal format: <code>cluster.local/ns/{namespace}/sa/{service-account}</code><br>
                            When ANY ALLOW policy exists, requests not matching any ALLOW rule are denied.<br>
                            Use <code>principals: ["*"]</code> to allow any authenticated identity.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>Frontend returns <code>200</code></li>
                                <li>Other-client returns <code>403</code></li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace authz-allow</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/tasks/security/authorization/authz-http-traffic/" target="_blank" class="ref-link">üìñ Authorization for HTTP Traffic</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 30 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">30</div>
                    <div class="question-content">
                        <div class="question-title">Create Authorization Policy Based on HTTP Method and Path</div>
                        <div class="question-description">Implement fine-grained access control. Allow GET requests to /get from anyone, but restrict POST requests to /post to admin service account only.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace authz-http
kubectl label namespace authz-http istio-injection=enabled

kubectl create serviceaccount admin -n authz-http
kubectl create serviceaccount user -n authz-http

<span class="comment"># Deploy API server</span>
kubectl apply -n authz-http -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml

<span class="comment"># Deploy admin client</span>
kubectl apply -n authz-http -f - &lt;&lt;EOF
apiVersion: apps/v1
kind: Deployment
metadata:
  name: admin-client
spec:
  replicas: 1
  selector:
    matchLabels:
      app: admin-client
  template:
    metadata:
      labels:
        app: admin-client
    spec:
      serviceAccountName: admin
      containers:
      - name: sleep
        image: curlimages/curl
        command: ["/bin/sleep", "3600"]
EOF

<span class="comment"># Deploy user client</span>
kubectl apply -n authz-http -f - &lt;&lt;EOF
apiVersion: apps/v1
kind: Deployment
metadata:
  name: user-client
spec:
  replicas: 1
  selector:
    matchLabels:
      app: user-client
  template:
    metadata:
      labels:
        app: user-client
    spec:
      serviceAccountName: user
      containers:
      - name: sleep
        image: curlimages/curl
        command: ["/bin/sleep", "3600"]
EOF

kubectl wait --for=condition=ready pod -l app=httpbin -n authz-http --timeout=120s
kubectl wait --for=condition=ready pod -l app=admin-client -n authz-http --timeout=120s
kubectl wait --for=condition=ready pod -l app=user-client -n authz-http --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create AuthorizationPolicy allowing GET on /get from anyone</li>
                            <li><strong>Task 2:</strong> Allow POST on /post only from admin SA</li>
                            <li><strong>Task 3:</strong> Test the policies</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1 & 2: Create combined AuthorizationPolicy</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: security.istio.io/v1
kind: AuthorizationPolicy
metadata:
  name: api-access
  namespace: authz-http
spec:
  selector:
    matchLabels:
      app: httpbin
  action: ALLOW
  rules:
  - to:
    - operation:
        methods: ["GET"]
        paths: ["/get", "/headers", "/ip"]
  - from:
    - source:
        principals: ["cluster.local/ns/authz-http/sa/admin"]
    to:
    - operation:
        methods: ["POST"]
        paths: ["/post"]
EOF

<span class="comment"># Task 3: Test the policies</span>
echo "User GET /get (should succeed):"
kubectl exec -n authz-http deploy/user-client -- curl -s httpbin:8000/get -o /dev/null -w "%{http_code}\n"

echo "User POST /post (should fail):"
kubectl exec -n authz-http deploy/user-client -- curl -s -X POST httpbin:8000/post -o /dev/null -w "%{http_code}\n"

echo "Admin POST /post (should succeed):"
kubectl exec -n authz-http deploy/admin-client -- curl -s -X POST httpbin:8000/post -o /dev/null -w "%{http_code}\n"</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><code>to.operation</code> matches request attributes: methods, paths, hosts, ports<br>
                            <code>from.source</code> matches caller attributes: principals, namespaces, ipBlocks<br>
                            Multiple rules in same policy = OR logic. Conditions within rule = AND logic.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>User GET /get: <code>200</code></li>
                                <li>User POST /post: <code>403</code></li>
                                <li>Admin POST /post: <code>200</code></li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace authz-http</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/config/security/authorization-policy/#Operation" target="_blank" class="ref-link">üìñ Authorization Operation</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 31 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">31</div>
                    <div class="question-content">
                        <div class="question-title">Configure JWT Authentication with RequestAuthentication</div>
                        <div class="question-description">Secure your API with JWT authentication. Configure RequestAuthentication to validate JWTs from a specific issuer and require valid tokens for access.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace jwt-test
kubectl label namespace jwt-test istio-injection=enabled

kubectl apply -n jwt-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n jwt-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n jwt-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n jwt-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a RequestAuthentication that validates JWTs from issuer <code>testing@secure.istio.io</code></li>
                            <li><strong>Task 2:</strong> Create an AuthorizationPolicy that requires valid JWT</li>
                            <li><strong>Task 3:</strong> Test with and without a valid JWT</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create RequestAuthentication</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: security.istio.io/v1
kind: RequestAuthentication
metadata:
  name: jwt-auth
  namespace: jwt-test
spec:
  selector:
    matchLabels:
      app: httpbin
  jwtRules:
  - issuer: "testing@secure.istio.io"
    jwksUri: "https://raw.githubusercontent.com/istio/istio/release-1.22/security/tools/jwt/samples/jwks.json"
EOF

<span class="comment"># Task 2: Create AuthorizationPolicy requiring JWT</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: security.istio.io/v1
kind: AuthorizationPolicy
metadata:
  name: require-jwt
  namespace: jwt-test
spec:
  selector:
    matchLabels:
      app: httpbin
  action: ALLOW
  rules:
  - from:
    - source:
        requestPrincipals: ["testing@secure.istio.io/testing@secure.istio.io"]
EOF

<span class="comment"># Get sample token</span>
TOKEN=$(curl -s https://raw.githubusercontent.com/istio/istio/release-1.22/security/tools/jwt/samples/demo.jwt)

<span class="comment"># Task 3: Test without JWT (should fail)</span>
echo "Request without JWT:"
kubectl exec -n jwt-test deploy/sleep -- curl -s httpbin:8000/get -o /dev/null -w "%{http_code}\n"

<span class="comment"># Test with valid JWT (should succeed)</span>
echo "Request with valid JWT:"
kubectl exec -n jwt-test deploy/sleep -- curl -s -H "Authorization: Bearer $TOKEN" httpbin:8000/get -o /dev/null -w "%{http_code}\n"</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>RequestAuthentication</strong>: Validates JWT format and signature<br>
                            <strong>AuthorizationPolicy with requestPrincipals</strong>: Requires valid JWT<br>
                            RequestAuthentication alone only rejects INVALID tokens, not missing ones.<br>
                            Principal format: <code>{issuer}/{subject}</code></p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>Request without JWT: <code>403</code></li>
                                <li>Request with valid JWT: <code>200</code></li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace jwt-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/config/security/request_authentication/" target="_blank" class="ref-link">üìñ RequestAuthentication</a>
                            <a href="https://istio.io/latest/docs/tasks/security/authentication/authn-policy/#end-user-authentication" target="_blank" class="ref-link">üìñ End-User Authentication</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 32 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">32</div>
                    <div class="question-content">
                        <div class="question-title">Configure TLS on Istio Ingress Gateway</div>
                        <div class="question-description">Secure external traffic to your application by configuring TLS termination on the Istio ingress gateway using a certificate and key.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Create namespace and deploy app</span>
kubectl create namespace tls-test
kubectl label namespace tls-test istio-injection=enabled

kubectl apply -n tls-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl wait --for=condition=ready pod -l app=httpbin -n tls-test --timeout=120s

<span class="comment"># Generate self-signed certificate</span>
openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout /tmp/tls.key -out /tmp/tls.crt \
  -subj "/CN=httpbin.example.com/O=example"

<span class="comment"># Create TLS secret in istio-system (for gateway)</span>
kubectl create secret tls httpbin-credential \
  --key=/tmp/tls.key --cert=/tmp/tls.crt \
  -n istio-system</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a Gateway with TLS mode SIMPLE using the certificate</li>
                            <li><strong>Task 2:</strong> Create a VirtualService routing to httpbin</li>
                            <li><strong>Task 3:</strong> Test HTTPS access to the service</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create Gateway with TLS</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: Gateway
metadata:
  name: httpbin-gateway
  namespace: tls-test
spec:
  selector:
    istio: ingressgateway
  servers:
  - port:
      number: 443
      name: https
      protocol: HTTPS
    tls:
      mode: SIMPLE
      credentialName: httpbin-credential
    hosts:
    - "httpbin.example.com"
EOF

<span class="comment"># Task 2: Create VirtualService</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: httpbin-vs
  namespace: tls-test
spec:
  hosts:
  - "httpbin.example.com"
  gateways:
  - httpbin-gateway
  http:
  - route:
    - destination:
        host: httpbin
        port:
          number: 8000
EOF

<span class="comment"># Get ingress IP</span>
INGRESS_IP=$(kubectl get svc istio-ingressgateway -n istio-system -o jsonpath='{.status.loadBalancer.ingress[0].ip}')
[ -z "$INGRESS_IP" ] && INGRESS_IP=$(kubectl get nodes -o jsonpath='{.items[0].status.addresses[?(@.type=="InternalIP")].address}')
SECURE_PORT=$(kubectl get svc istio-ingressgateway -n istio-system -o jsonpath='{.spec.ports[?(@.name=="https")].nodePort}')

<span class="comment"># Task 3: Test HTTPS access</span>
echo "Testing HTTPS access:"
curl -sk --resolve "httpbin.example.com:${SECURE_PORT:-443}:${INGRESS_IP}" \
  "https://httpbin.example.com:${SECURE_PORT:-443}/get" | head -10</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>TLS modes:</strong><br>
                            ‚Ä¢ <code>SIMPLE</code>: Standard TLS (server cert only)<br>
                            ‚Ä¢ <code>MUTUAL</code>: mTLS (client + server certs)<br>
                            ‚Ä¢ <code>PASSTHROUGH</code>: SNI-based routing, no termination<br>
                            Secret must be in <code>istio-system</code> namespace for ingress gateway.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>Gateway with TLS mode SIMPLE created</li>
                                <li>HTTPS request returns httpbin response</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace tls-test
kubectl delete secret httpbin-credential -n istio-system
rm -f /tmp/tls.key /tmp/tls.crt</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/tasks/traffic-management/ingress/secure-ingress/" target="_blank" class="ref-link">üìñ Secure Gateways</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 33 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">33</div>
                    <div class="question-content">
                        <div class="question-title">Verify Workload Certificate Information</div>
                        <div class="question-description">Inspect the mTLS certificates used by workloads to verify their identity and expiration. Use istioctl to examine the certificate chain.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace cert-test
kubectl label namespace cert-test istio-injection=enabled

kubectl apply -n cert-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl wait --for=condition=ready pod -l app=httpbin -n cert-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Use <code>istioctl proxy-config secret</code> to view certificate information</li>
                            <li><strong>Task 2:</strong> Verify the SPIFFE identity of the workload</li>
                            <li><strong>Task 3:</strong> Check certificate validity</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Get pod name</span>
POD=$(kubectl get pod -n cert-test -l app=httpbin -o jsonpath='{.items[0].metadata.name}')

<span class="comment"># Task 1: View certificate secrets</span>
echo "=== Certificate Secrets ==="
istioctl proxy-config secret $POD -n cert-test

<span class="comment"># Task 2 & 3: View detailed certificate info</span>
echo ""
echo "=== Certificate Details ==="
istioctl proxy-config secret $POD -n cert-test -o json | jq -r '.dynamicActiveSecrets[0].secret.tlsCertificate.certificateChain.inlineBytes' | base64 -d | openssl x509 -text -noout | head -30

<span class="comment"># Alternative: Use istioctl x describe</span>
echo ""
echo "=== Workload Description ==="
istioctl x describe pod $POD -n cert-test | grep -A5 "Certificate"</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p>SPIFFE ID format: <code>spiffe://cluster.local/ns/{namespace}/sa/{service-account}</code><br>
                            Certificates are automatically rotated by Istio (default 24h validity).<br>
                            Use <code>istioctl proxy-config secret</code> to verify mTLS setup.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>proxy-config shows ROOTCA and default certificate</li>
                                <li>Certificate shows SPIFFE URI in SAN</li>
                                <li>Certificate validity is shown</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace cert-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/concepts/security/#pki" target="_blank" class="ref-link">üìñ Istio PKI</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 34 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">34</div>
                    <div class="question-content">
                        <div class="question-title">Allow Traffic from Specific Namespace</div>
                        <div class="question-description">Configure an AuthorizationPolicy to allow traffic only from workloads in a specific namespace. Services in "allowed" namespace can access backend, but "blocked" cannot.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Create namespaces</span>
kubectl create namespace backend
kubectl create namespace allowed
kubectl create namespace blocked

kubectl label namespace backend istio-injection=enabled
kubectl label namespace allowed istio-injection=enabled
kubectl label namespace blocked istio-injection=enabled

<span class="comment"># Deploy backend</span>
kubectl apply -n backend -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml

<span class="comment"># Deploy clients</span>
kubectl apply -n allowed -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml
kubectl apply -n blocked -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n backend --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n allowed --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n blocked --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create AuthorizationPolicy allowing only traffic from namespace "allowed"</li>
                            <li><strong>Task 2:</strong> Verify "allowed" can access backend</li>
                            <li><strong>Task 3:</strong> Verify "blocked" cannot access backend</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create AuthorizationPolicy</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: security.istio.io/v1
kind: AuthorizationPolicy
metadata:
  name: allow-from-namespace
  namespace: backend
spec:
  selector:
    matchLabels:
      app: httpbin
  action: ALLOW
  rules:
  - from:
    - source:
        namespaces: ["allowed"]
EOF

<span class="comment"># Task 2: Test from allowed namespace (should succeed)</span>
echo "From 'allowed' namespace:"
kubectl exec -n allowed deploy/sleep -- curl -s httpbin.backend:8000/get -o /dev/null -w "%{http_code}\n"

<span class="comment"># Task 3: Test from blocked namespace (should fail)</span>
echo "From 'blocked' namespace:"
kubectl exec -n blocked deploy/sleep -- curl -s httpbin.backend:8000/get -o /dev/null -w "%{http_code}\n"</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><code>source.namespaces</code>: Match by source namespace<br>
                            <code>source.principals</code>: Match by service account<br>
                            <code>source.ipBlocks</code>: Match by source IP CIDR</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>Request from "allowed": <code>200</code></li>
                                <li>Request from "blocked": <code>403</code></li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace backend allowed blocked</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/config/security/authorization-policy/#Source" target="_blank" class="ref-link">üìñ Authorization Source</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 35 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">35</div>
                    <div class="question-content">
                        <div class="question-title">Create Default Deny-All Authorization Policy</div>
                        <div class="question-description">Implement zero-trust security by creating a default deny-all policy for a namespace. No traffic is allowed unless explicitly permitted.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace zero-trust
kubectl label namespace zero-trust istio-injection=enabled

kubectl apply -n zero-trust -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n zero-trust -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n zero-trust --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n zero-trust --timeout=120s

<span class="comment"># Verify traffic works before policy</span>
echo "Before deny-all policy:"
kubectl exec -n zero-trust deploy/sleep -- curl -s httpbin:8000/get -o /dev/null -w "%{http_code}\n"</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a deny-all AuthorizationPolicy for the namespace</li>
                            <li><strong>Task 2:</strong> Verify all traffic is blocked</li>
                            <li><strong>Task 3:</strong> Create an ALLOW policy to restore specific access</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create deny-all policy (empty spec)</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: security.istio.io/v1
kind: AuthorizationPolicy
metadata:
  name: deny-all
  namespace: zero-trust
spec: {}
EOF

<span class="comment"># Task 2: Verify traffic is blocked</span>
echo "After deny-all policy:"
kubectl exec -n zero-trust deploy/sleep -- curl -s httpbin:8000/get -o /dev/null -w "%{http_code}\n"

<span class="comment"># Task 3: Create ALLOW policy to restore specific access</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: security.istio.io/v1
kind: AuthorizationPolicy
metadata:
  name: allow-sleep-to-httpbin
  namespace: zero-trust
spec:
  selector:
    matchLabels:
      app: httpbin
  action: ALLOW
  rules:
  - from:
    - source:
        principals: ["cluster.local/ns/zero-trust/sa/sleep"]
EOF

echo "After ALLOW policy for sleep:"
kubectl exec -n zero-trust deploy/sleep -- curl -s httpbin:8000/get -o /dev/null -w "%{http_code}\n"</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>Deny-all</strong>: AuthorizationPolicy with empty spec <code>{}</code><br>
                            This blocks ALL traffic to ALL workloads in the namespace.<br>
                            Then add specific ALLOW policies for permitted traffic.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>Before policy: <code>200</code></li>
                                <li>After deny-all: <code>403</code></li>
                                <li>After ALLOW policy: <code>200</code></li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace zero-trust</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/ops/best-practices/security/#use-default-deny-patterns" target="_blank" class="ref-link">üìñ Default Deny Patterns</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 36 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">36</div>
                    <div class="question-content">
                        <div class="question-title">Configure DestinationRule TLS Settings</div>
                        <div class="question-description">Configure client-side TLS settings for outbound traffic. Use DestinationRule to specify ISTIO_MUTUAL mode for traffic to a specific host.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace dr-tls
kubectl label namespace dr-tls istio-injection=enabled

kubectl apply -n dr-tls -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n dr-tls -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n dr-tls --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n dr-tls --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Create a DestinationRule with ISTIO_MUTUAL TLS mode</li>
                            <li><strong>Task 2:</strong> Verify TLS settings are applied</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Create DestinationRule with TLS settings</span>
kubectl apply -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: DestinationRule
metadata:
  name: httpbin-tls
  namespace: dr-tls
spec:
  host: httpbin
  trafficPolicy:
    tls:
      mode: ISTIO_MUTUAL
EOF

<span class="comment"># Task 2: Verify configuration</span>
kubectl get destinationrule httpbin-tls -n dr-tls -o yaml | grep -A3 tls

<span class="comment"># Test connectivity</span>
echo "Testing with ISTIO_MUTUAL TLS:"
kubectl exec -n dr-tls deploy/sleep -- curl -s httpbin:8000/get -o /dev/null -w "%{http_code}\n"

<span class="comment"># Check proxy config</span>
POD=$(kubectl get pod -n dr-tls -l app=sleep -o jsonpath='{.items[0].metadata.name}')
istioctl proxy-config cluster $POD -n dr-tls --fqdn httpbin.dr-tls.svc.cluster.local -o json | jq '.[0].transportSocket' | head -10</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>DestinationRule TLS modes (client-side):</strong><br>
                            ‚Ä¢ <code>DISABLE</code>: No TLS<br>
                            ‚Ä¢ <code>SIMPLE</code>: TLS (no client cert)<br>
                            ‚Ä¢ <code>MUTUAL</code>: mTLS with specified certs<br>
                            ‚Ä¢ <code>ISTIO_MUTUAL</code>: mTLS with Istio-managed certs<br><br>
                            PeerAuthentication = server-side | DestinationRule TLS = client-side</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>DestinationRule shows tls.mode: ISTIO_MUTUAL</li>
                                <li>Request succeeds with <code>200</code></li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace dr-tls</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/config/networking/destination-rule/#ClientTLSSettings" target="_blank" class="ref-link">üìñ ClientTLSSettings</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Domain 3 Complete Summary -->
            <div class="domain-summary security">
                <div class="domain-summary-header">
                    <div class="domain-summary-icon">üîê</div>
                    <div class="domain-summary-title">Domain 3 Complete: Securing Workloads</div>
                </div>
                <div class="domain-summary-grid">
                    <div class="domain-summary-item"><span class="q-num">Q25</span><span class="q-title">Namespace STRICT mTLS</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q26</span><span class="q-title">Mesh-Wide STRICT mTLS</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q27</span><span class="q-title">Port-Level mTLS Exception</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q28</span><span class="q-title">DENY AuthorizationPolicy</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q29</span><span class="q-title">ALLOW by Service Account</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q30</span><span class="q-title">Authorization by Method/Path</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q31</span><span class="q-title">JWT Authentication</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q32</span><span class="q-title">Gateway TLS Configuration</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q33</span><span class="q-title">Verify Workload Certificates</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q34</span><span class="q-title">Allow Traffic from Namespace</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q35</span><span class="q-title">Default Deny-All Policy</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q36</span><span class="q-title">DestinationRule TLS Settings</span></div>
                </div>
            </div>

        </div>
    </section>

    <section id="troubleshoot" class="domain-section troubleshoot">
        <div class="container">
            <div class="domain-header">
                <div class="domain-badge">Domain 4 ‚Ä¢ 20% of Exam ‚Ä¢ 10 Questions</div>
                <h2 class="domain-title">Troubleshooting</h2>
                <p class="domain-description">istioctl analyze, proxy-status, proxy-config, debugging techniques.</p>
            </div>

            <!-- QUESTION 37 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">37</div>
                    <div class="question-content">
                        <div class="question-title">Analyze Istio Configuration for Issues</div>
                        <div class="question-description">Use istioctl analyze to detect misconfigurations, warnings, and errors in your Istio setup. Identify and fix any issues found.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Create namespace with a misconfiguration</span>
kubectl create namespace analyze-test
kubectl label namespace analyze-test istio-injection=enabled

kubectl apply -n analyze-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl wait --for=condition=ready pod -l app=httpbin -n analyze-test --timeout=120s

<span class="comment"># Create a VirtualService that references non-existent gateway (misconfiguration)</span>
kubectl apply -n analyze-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: broken-vs
spec:
  hosts:
  - httpbin
  gateways:
  - non-existent-gateway
  http:
  - route:
    - destination:
        host: httpbin
        port:
          number: 8000
EOF</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Run <code>istioctl analyze</code> to detect configuration issues</li>
                            <li><strong>Task 2:</strong> Analyze a specific namespace</li>
                            <li><strong>Task 3:</strong> Analyze a local YAML file before applying</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Analyze all namespaces</span>
echo "=== Analyzing all namespaces ==="
istioctl analyze --all-namespaces

<span class="comment"># Task 2: Analyze specific namespace</span>
echo ""
echo "=== Analyzing analyze-test namespace ==="
istioctl analyze -n analyze-test

<span class="comment"># Task 3: Analyze local file before applying</span>
cat &lt;&lt;EOF > /tmp/test-vs.yaml
apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: test-vs
  namespace: analyze-test
spec:
  hosts:
  - httpbin
  gateways:
  - another-missing-gateway
  http:
  - route:
    - destination:
        host: httpbin
        port:
          number: 8000
EOF

echo ""
echo "=== Analyzing local file ==="
istioctl analyze /tmp/test-vs.yaml -n analyze-test

<span class="comment"># Show verbose output with warnings</span>
echo ""
echo "=== Verbose analysis ==="
istioctl analyze -n analyze-test --output yaml</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><code>istioctl analyze</code> detects common issues like:<br>
                            ‚Ä¢ Missing gateways referenced by VirtualServices<br>
                            ‚Ä¢ Missing destination hosts<br>
                            ‚Ä¢ Conflicting configurations<br>
                            ‚Ä¢ Schema validation errors<br>
                            Use <code>--all-namespaces</code> for cluster-wide analysis.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>Analysis shows warning about missing gateway</li>
                                <li>Error code like <code>IST0101</code> (ReferencedResourceNotFound)</li>
                                <li>Local file analysis catches issues before apply</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace analyze-test
rm -f /tmp/test-vs.yaml</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/commands/istioctl/#istioctl-analyze" target="_blank" class="ref-link">üìñ istioctl analyze</a>
                            <a href="https://istio.io/latest/docs/reference/config/analysis/" target="_blank" class="ref-link">üìñ Configuration Analysis Messages</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 38 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">38</div>
                    <div class="question-content">
                        <div class="question-title">Check Proxy Synchronization Status</div>
                        <div class="question-description">Use istioctl proxy-status to verify that all sidecar proxies are synchronized with the control plane and receiving configuration updates.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace sync-test
kubectl label namespace sync-test istio-injection=enabled

kubectl apply -n sync-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n sync-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n sync-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n sync-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Check synchronization status of all proxies</li>
                            <li><strong>Task 2:</strong> Check status of a specific proxy</li>
                            <li><strong>Task 3:</strong> Identify any proxies that are out of sync</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Check all proxy status</span>
echo "=== All Proxy Status ==="
istioctl proxy-status

<span class="comment"># Task 2: Check specific pod's proxy status</span>
POD=$(kubectl get pod -n sync-test -l app=httpbin -o jsonpath='{.items[0].metadata.name}')
echo ""
echo "=== Specific Pod Status ==="
istioctl proxy-status $POD.sync-test

<span class="comment"># Task 3: Check for any STALE or NOT SENT status</span>
echo ""
echo "=== Checking for sync issues ==="
istioctl proxy-status | grep -E "STALE|NOT SENT" || echo "All proxies are SYNCED"

<span class="comment"># Show xDS version details</span>
echo ""
echo "=== xDS Version Details ==="
istioctl proxy-status | head -5</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>Status meanings:</strong><br>
                            ‚Ä¢ <code>SYNCED</code>: Proxy has latest config from Istiod<br>
                            ‚Ä¢ <code>NOT SENT</code>: Istiod hasn't sent config (might be new)<br>
                            ‚Ä¢ <code>STALE</code>: Istiod sent config but proxy hasn't ACKed<br><br>
                            Columns: CDS (clusters), LDS (listeners), EDS (endpoints), RDS (routes)</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>All proxies show <code>SYNCED</code> status</li>
                                <li>CDS, LDS, EDS, RDS columns all show SYNCED</li>
                                <li>Istiod version matches proxy version</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace sync-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/commands/istioctl/#istioctl-proxy-status" target="_blank" class="ref-link">üìñ istioctl proxy-status</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 39 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">39</div>
                    <div class="question-content">
                        <div class="question-title">Inspect Envoy Cluster Configuration</div>
                        <div class="question-description">Use istioctl proxy-config to examine the cluster (upstream service) configuration of a sidecar proxy. Debug service discovery issues.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace cluster-test
kubectl label namespace cluster-test istio-injection=enabled

kubectl apply -n cluster-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n cluster-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n cluster-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n cluster-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> List all clusters (upstream services) known to the sleep proxy</li>
                            <li><strong>Task 2:</strong> Filter clusters for the httpbin service</li>
                            <li><strong>Task 3:</strong> View detailed cluster config in JSON format</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Get sleep pod name</span>
SLEEP_POD=$(kubectl get pod -n cluster-test -l app=sleep -o jsonpath='{.items[0].metadata.name}')

<span class="comment"># Task 1: List all clusters</span>
echo "=== All Clusters ==="
istioctl proxy-config clusters $SLEEP_POD -n cluster-test | head -20

<span class="comment"># Task 2: Filter for httpbin</span>
echo ""
echo "=== httpbin Clusters ==="
istioctl proxy-config clusters $SLEEP_POD -n cluster-test --fqdn httpbin.cluster-test.svc.cluster.local

<span class="comment"># Task 3: Detailed JSON output</span>
echo ""
echo "=== Detailed Cluster Config ==="
istioctl proxy-config clusters $SLEEP_POD -n cluster-test --fqdn httpbin.cluster-test.svc.cluster.local -o json | jq '.[0] | {name, type, edsClusterConfig, connectTimeout}'

<span class="comment"># Check cluster with subsets (if DestinationRule exists)</span>
echo ""
echo "=== Cluster Summary ==="
istioctl proxy-config clusters $SLEEP_POD -n cluster-test | grep -c "cluster-test" | xargs echo "Total clusters in namespace:"</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>Cluster config shows:</strong><br>
                            ‚Ä¢ SERVICE FQDN: Full service name<br>
                            ‚Ä¢ PORT: Service port<br>
                            ‚Ä¢ SUBSET: DestinationRule subset name<br>
                            ‚Ä¢ DESTINATION RULE: Applied DestinationRule<br>
                            Use <code>--fqdn</code> to filter by service name.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>httpbin cluster appears in the list</li>
                                <li>Cluster type is EDS (Endpoint Discovery Service)</li>
                                <li>Connect timeout is configured</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace cluster-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/commands/istioctl/#istioctl-proxy-config-cluster" target="_blank" class="ref-link">üìñ proxy-config cluster</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 40 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">40</div>
                    <div class="question-content">
                        <div class="question-title">Inspect Envoy Route Configuration</div>
                        <div class="question-description">Use istioctl proxy-config routes to examine the routing rules configured in a sidecar proxy. Debug traffic routing issues.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace route-test
kubectl label namespace route-test istio-injection=enabled

kubectl apply -n route-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n route-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n route-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n route-test --timeout=120s

<span class="comment"># Create a VirtualService with specific routing</span>
kubectl apply -n route-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: httpbin-routes
spec:
  hosts:
  - httpbin
  http:
  - match:
    - uri:
        prefix: /status
    route:
    - destination:
        host: httpbin
        port:
          number: 8000
  - route:
    - destination:
        host: httpbin
        port:
          number: 8000
EOF</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> List all routes configured in the sleep proxy</li>
                            <li><strong>Task 2:</strong> Filter routes for httpbin service</li>
                            <li><strong>Task 3:</strong> View route details including match conditions</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Get sleep pod name</span>
SLEEP_POD=$(kubectl get pod -n route-test -l app=sleep -o jsonpath='{.items[0].metadata.name}')

<span class="comment"># Task 1: List all routes</span>
echo "=== All Routes ==="
istioctl proxy-config routes $SLEEP_POD -n route-test | head -20

<span class="comment"># Task 2: Filter for httpbin routes</span>
echo ""
echo "=== httpbin Routes ==="
istioctl proxy-config routes $SLEEP_POD -n route-test --name 8000

<span class="comment"># Task 3: View detailed route config</span>
echo ""
echo "=== Detailed Route Config ==="
istioctl proxy-config routes $SLEEP_POD -n route-test --name 8000 -o json | jq '.[0].virtualHosts[] | select(.name | contains("httpbin"))' | head -40

<span class="comment"># View all route names</span>
echo ""
echo "=== Route Names ==="
istioctl proxy-config routes $SLEEP_POD -n route-test -o json | jq -r '.[].name' | sort -u</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>Route config shows:</strong><br>
                            ‚Ä¢ NAME: Route config name (usually port number)<br>
                            ‚Ä¢ DOMAINS: Hosts the route applies to<br>
                            ‚Ä¢ MATCH: URI/header match conditions<br>
                            ‚Ä¢ VIRTUAL SERVICE: Applied VirtualService<br>
                            Route names like <code>8000</code> correspond to service ports.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>Routes show httpbin as destination</li>
                                <li>VirtualService match conditions visible (/status prefix)</li>
                                <li>Route config name matches service port</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace route-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/commands/istioctl/#istioctl-proxy-config-route" target="_blank" class="ref-link">üìñ proxy-config route</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 41 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">41</div>
                    <div class="question-content">
                        <div class="question-title">Inspect Envoy Listener Configuration</div>
                        <div class="question-description">Use istioctl proxy-config listeners to examine the listeners (inbound/outbound ports) configured in a sidecar proxy.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace listener-test
kubectl label namespace listener-test istio-injection=enabled

kubectl apply -n listener-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n listener-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n listener-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n listener-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> List all listeners configured in the httpbin proxy</li>
                            <li><strong>Task 2:</strong> Identify inbound vs outbound listeners</li>
                            <li><strong>Task 3:</strong> View listener details for a specific port</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Get httpbin pod name</span>
HTTPBIN_POD=$(kubectl get pod -n listener-test -l app=httpbin -o jsonpath='{.items[0].metadata.name}')

<span class="comment"># Task 1: List all listeners</span>
echo "=== All Listeners ==="
istioctl proxy-config listeners $HTTPBIN_POD -n listener-test

<span class="comment"># Task 2: Identify inbound listeners (virtualInbound)</span>
echo ""
echo "=== Inbound Listeners ==="
istioctl proxy-config listeners $HTTPBIN_POD -n listener-test | grep -E "INBOUND|virtualInbound"

<span class="comment"># Identify outbound listeners</span>
echo ""
echo "=== Outbound Listeners ==="
istioctl proxy-config listeners $HTTPBIN_POD -n listener-test | grep "OUTBOUND" | head -10

<span class="comment"># Task 3: View specific listener details</span>
echo ""
echo "=== Listener on port 8000 ==="
istioctl proxy-config listeners $HTTPBIN_POD -n listener-test --port 8000 -o json | jq '.[0] | {name, address, filterChains: [.filterChains[0].filters[0].name]}'

<span class="comment"># Count listeners</span>
echo ""
echo "=== Listener Summary ==="
echo "Total listeners: $(istioctl proxy-config listeners $HTTPBIN_POD -n listener-test | wc -l)"</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>Listener types:</strong><br>
                            ‚Ä¢ <code>virtualInbound</code>: Handles incoming traffic to the pod<br>
                            ‚Ä¢ <code>virtualOutbound</code>: Handles outgoing traffic from the pod<br>
                            ‚Ä¢ <code>0.0.0.0:15006</code>: Inbound traffic interceptor<br>
                            ‚Ä¢ <code>0.0.0.0:15001</code>: Outbound traffic interceptor</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>virtualInbound listener on port 15006</li>
                                <li>virtualOutbound listener on port 15001</li>
                                <li>Listener for httpbin service port 8000</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace listener-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/commands/istioctl/#istioctl-proxy-config-listener" target="_blank" class="ref-link">üìñ proxy-config listener</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 42 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">42</div>
                    <div class="question-content">
                        <div class="question-title">Inspect Envoy Endpoint Configuration</div>
                        <div class="question-description">Use istioctl proxy-config endpoints to examine the endpoints (pod IPs) known to a sidecar proxy. Debug service discovery and load balancing issues.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace endpoint-test
kubectl label namespace endpoint-test istio-injection=enabled

<span class="comment"># Deploy httpbin with multiple replicas</span>
kubectl apply -n endpoint-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl scale deployment httpbin -n endpoint-test --replicas=3

kubectl apply -n endpoint-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n endpoint-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n endpoint-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> List endpoints known to the sleep proxy</li>
                            <li><strong>Task 2:</strong> Filter endpoints for httpbin service</li>
                            <li><strong>Task 3:</strong> Verify all httpbin pod IPs are listed as healthy</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Get sleep pod name</span>
SLEEP_POD=$(kubectl get pod -n endpoint-test -l app=sleep -o jsonpath='{.items[0].metadata.name}')

<span class="comment"># Task 1: List all endpoints</span>
echo "=== All Endpoints (first 20) ==="
istioctl proxy-config endpoints $SLEEP_POD -n endpoint-test | head -20

<span class="comment"># Task 2: Filter for httpbin endpoints</span>
echo ""
echo "=== httpbin Endpoints ==="
istioctl proxy-config endpoints $SLEEP_POD -n endpoint-test --cluster "outbound|8000||httpbin.endpoint-test.svc.cluster.local"

<span class="comment"># Task 3: Verify healthy endpoints</span>
echo ""
echo "=== Endpoint Health Status ==="
istioctl proxy-config endpoints $SLEEP_POD -n endpoint-test --cluster "outbound|8000||httpbin.endpoint-test.svc.cluster.local" -o json | jq '.[].hostStatuses[] | {address: .address.socketAddress.address, health: .healthStatus.edsHealthStatus}'

<span class="comment"># Compare with actual pod IPs</span>
echo ""
echo "=== Actual httpbin Pod IPs ==="
kubectl get pods -n endpoint-test -l app=httpbin -o wide | awk '{print $6}'</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>Endpoint status:</strong><br>
                            ‚Ä¢ <code>HEALTHY</code>: Endpoint is available<br>
                            ‚Ä¢ <code>UNHEALTHY</code>: Failed health checks<br>
                            ‚Ä¢ <code>DRAINING</code>: Being removed<br>
                            Cluster name format: <code>outbound|PORT||FQDN</code></p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>3 endpoints listed for httpbin (matching replica count)</li>
                                <li>All endpoints show HEALTHY status</li>
                                <li>Endpoint IPs match actual pod IPs</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace endpoint-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/reference/commands/istioctl/#istioctl-proxy-config-endpoint" target="_blank" class="ref-link">üìñ proxy-config endpoint</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 43 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">43</div>
                    <div class="question-content">
                        <div class="question-title">Debug Sidecar Injection Issues</div>
                        <div class="question-description">Troubleshoot why sidecar injection is not working. Check namespace labels, pod annotations, and injection webhook configuration.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Create namespace WITHOUT injection label (simulating issue)</span>
kubectl create namespace injection-debug

<span class="comment"># Deploy app (will NOT get sidecar)</span>
kubectl apply -n injection-debug -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl wait --for=condition=ready pod -l app=httpbin -n injection-debug --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Verify if sidecar was injected (check container count)</li>
                            <li><strong>Task 2:</strong> Check namespace labels for injection</li>
                            <li><strong>Task 3:</strong> Verify injection webhook is working</li>
                            <li><strong>Task 4:</strong> Fix the issue and redeploy</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Check container count (should be 1, not 2)</span>
echo "=== Container Count (1 = no sidecar, 2 = has sidecar) ==="
kubectl get pods -n injection-debug -o jsonpath='{range .items[*]}{.metadata.name}{" containers: "}{range .spec.containers[*]}{.name}{" "}{end}{"\n"}{end}'

<span class="comment"># Task 2: Check namespace labels</span>
echo ""
echo "=== Namespace Labels ==="
kubectl get namespace injection-debug --show-labels

<span class="comment"># Task 3: Check webhook configuration</span>
echo ""
echo "=== Injection Webhook ==="
kubectl get mutatingwebhookconfigurations | grep istio

echo ""
echo "=== Webhook Details ==="
kubectl get mutatingwebhookconfiguration istio-sidecar-injector -o jsonpath='{.webhooks[0].namespaceSelector}' | jq .

<span class="comment"># Task 4: Fix - Add injection label and redeploy</span>
echo ""
echo "=== Fixing: Adding injection label ==="
kubectl label namespace injection-debug istio-injection=enabled

<span class="comment"># Delete and recreate pod to get sidecar</span>
kubectl delete pod -n injection-debug -l app=httpbin
kubectl wait --for=condition=ready pod -l app=httpbin -n injection-debug --timeout=120s

<span class="comment"># Verify fix</span>
echo ""
echo "=== After Fix: Container Count ==="
kubectl get pods -n injection-debug -o jsonpath='{range .items[*]}{.metadata.name}{" containers: "}{range .spec.containers[*]}{.name}{" "}{end}{"\n"}{end}'</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>Injection troubleshooting checklist:</strong><br>
                            1. Namespace label: <code>istio-injection=enabled</code><br>
                            2. Pod annotation: <code>sidecar.istio.io/inject: "true"</code><br>
                            3. Webhook exists: <code>istio-sidecar-injector</code><br>
                            4. Istiod is running<br>
                            Pods must be recreated after adding labels!</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>Before fix: 1 container (httpbin only)</li>
                                <li>After fix: 2 containers (httpbin + istio-proxy)</li>
                                <li>Namespace has <code>istio-injection=enabled</code> label</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace injection-debug</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/ops/common-problems/injection/" target="_blank" class="ref-link">üìñ Sidecar Injection Problems</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 44 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">44</div>
                    <div class="question-content">
                        <div class="question-title">View and Analyze Envoy Access Logs</div>
                        <div class="question-description">Enable and examine Envoy access logs to debug traffic issues. Understand log format and identify request failures.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Ensure access logging is enabled</span>
istioctl install --set meshConfig.accessLogFile=/dev/stdout -y

kubectl create namespace logs-test
kubectl label namespace logs-test istio-injection=enabled

kubectl apply -n logs-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n logs-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n logs-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n logs-test --timeout=120s</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Generate traffic and view access logs</li>
                            <li><strong>Task 2:</strong> Identify key fields in the log output</li>
                            <li><strong>Task 3:</strong> Find failed requests in the logs</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: Generate traffic</span>
echo "=== Generating traffic ==="
kubectl exec -n logs-test deploy/sleep -- curl -s httpbin:8000/get -o /dev/null
kubectl exec -n logs-test deploy/sleep -- curl -s httpbin:8000/status/500 -o /dev/null
kubectl exec -n logs-test deploy/sleep -- curl -s httpbin:8000/status/404 -o /dev/null

<span class="comment"># View httpbin access logs (inbound)</span>
echo ""
echo "=== httpbin Access Logs (last 10 lines) ==="
kubectl logs -n logs-test deploy/httpbin -c istio-proxy --tail=10

<span class="comment"># Task 2: Parse key fields from JSON logs</span>
echo ""
echo "=== Parsed Log Fields ==="
kubectl logs -n logs-test deploy/httpbin -c istio-proxy --tail=5 | head -1 | jq '{
  method: .method,
  path: .path,
  response_code: .response_code,
  response_flags: .response_flags,
  upstream_cluster: .upstream_cluster,
  duration: .duration
}' 2>/dev/null || echo "Logs may be in text format"

<span class="comment"># Task 3: Find failed requests (non-2xx)</span>
echo ""
echo "=== Failed Requests ==="
kubectl logs -n logs-test deploy/httpbin -c istio-proxy --tail=20 | grep -E '"response_code":(4|5)[0-9]{2}' || echo "Check text format logs for status codes"

<span class="comment"># View sleep outbound logs</span>
echo ""
echo "=== sleep Outbound Logs ==="
kubectl logs -n logs-test deploy/sleep -c istio-proxy --tail=5</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>Key access log fields:</strong><br>
                            ‚Ä¢ <code>response_code</code>: HTTP status code<br>
                            ‚Ä¢ <code>response_flags</code>: Envoy-specific flags (UH=no healthy upstream, NR=no route)<br>
                            ‚Ä¢ <code>upstream_cluster</code>: Destination service<br>
                            ‚Ä¢ <code>duration</code>: Request time in ms<br>
                            Logs appear in <code>istio-proxy</code> container.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>Access logs visible in istio-proxy container</li>
                                <li>200, 404, and 500 response codes visible</li>
                                <li>Request path and duration logged</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace logs-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/tasks/observability/logs/access-log/" target="_blank" class="ref-link">üìñ Access Logging</a>
                            <a href="https://www.envoyproxy.io/docs/envoy/latest/configuration/observability/access_log/usage#command-operators" target="_blank" class="ref-link">üìñ Envoy Log Format</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 45 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">45</div>
                    <div class="question-content">
                        <div class="question-title">Debug Traffic Routing with istioctl</div>
                        <div class="question-description">Use istioctl experimental describe to understand how traffic flows to a specific pod and identify any routing issues.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl create namespace describe-test
kubectl label namespace describe-test istio-injection=enabled

kubectl apply -n describe-test -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
kubectl apply -n describe-test -f https://raw.githubusercontent.com/istio/istio/master/samples/sleep/sleep.yaml

kubectl wait --for=condition=ready pod -l app=httpbin -n describe-test --timeout=120s
kubectl wait --for=condition=ready pod -l app=sleep -n describe-test --timeout=120s

<span class="comment"># Create some Istio resources</span>
kubectl apply -n describe-test -f - &lt;&lt;EOF
apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: httpbin-vs
spec:
  hosts:
  - httpbin
  http:
  - timeout: 10s
    route:
    - destination:
        host: httpbin
        port:
          number: 8000
---
apiVersion: networking.istio.io/v1
kind: DestinationRule
metadata:
  name: httpbin-dr
spec:
  host: httpbin
  trafficPolicy:
    connectionPool:
      http:
        http1MaxPendingRequests: 100
EOF</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> Use <code>istioctl x describe</code> to analyze the httpbin pod</li>
                            <li><strong>Task 2:</strong> Identify applied VirtualServices and DestinationRules</li>
                            <li><strong>Task 3:</strong> Check mTLS status and policies</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Get pod names</span>
HTTPBIN_POD=$(kubectl get pod -n describe-test -l app=httpbin -o jsonpath='{.items[0].metadata.name}')

<span class="comment"># Task 1, 2, 3: Describe the pod</span>
echo "=== Pod Description ==="
istioctl x describe pod $HTTPBIN_POD -n describe-test

<span class="comment"># Describe the service</span>
echo ""
echo "=== Service Description ==="
istioctl x describe service httpbin -n describe-test

<span class="comment"># Check what's affecting the workload</span>
echo ""
echo "=== Applied Policies ==="
kubectl get virtualservice,destinationrule,peerauthentication,authorizationpolicy -n describe-test

<span class="comment"># Verify routing from sleep perspective</span>
SLEEP_POD=$(kubectl get pod -n describe-test -l app=sleep -o jsonpath='{.items[0].metadata.name}')
echo ""
echo "=== Routing from Sleep to httpbin ==="
istioctl proxy-config routes $SLEEP_POD -n describe-test --name 8000 | grep httpbin</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><code>istioctl x describe</code> shows:<br>
                            ‚Ä¢ Applied VirtualServices and DestinationRules<br>
                            ‚Ä¢ mTLS mode and PeerAuthentication policies<br>
                            ‚Ä¢ AuthorizationPolicies affecting the workload<br>
                            ‚Ä¢ Service ports and endpoints<br>
                            The <code>x</code> indicates experimental command.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>VirtualService <code>httpbin-vs</code> shown with 10s timeout</li>
                                <li>DestinationRule <code>httpbin-dr</code> shown</li>
                                <li>mTLS status displayed</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre>kubectl delete namespace describe-test</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/ops/diagnostic-tools/istioctl-describe/" target="_blank" class="ref-link">üìñ istioctl describe</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QUESTION 46 -->
            <div class="question-card">
                <div class="question-header" onclick="toggleQuestion(this)">
                    <div class="question-number">46</div>
                    <div class="question-content">
                        <div class="question-title">Check Istiod Control Plane Logs</div>
                        <div class="question-description">Examine Istiod logs to debug control plane issues, configuration distribution problems, and certificate issuance.</div>
                    </div>
                    <div class="question-toggle">‚ñº</div>
                </div>
                <div class="answer-section">
                    <div class="sub-section">
                        <div class="sub-section-title prereq">üìã Prerequisites</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Ensure Istio is installed and running</span>
kubectl get pods -n istio-system -l app=istiod</pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title task">üéØ Task</div>
                        <ul class="task-list">
                            <li><strong>Task 1:</strong> View recent Istiod logs</li>
                            <li><strong>Task 2:</strong> Filter logs for errors and warnings</li>
                            <li><strong>Task 3:</strong> Check for xDS push events</li>
                            <li><strong>Task 4:</strong> Verify certificate authority is working</li>
                        </ul>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title solution">‚úÖ Solution</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># Task 1: View recent logs</span>
echo "=== Recent Istiod Logs ==="
kubectl logs -n istio-system deploy/istiod --tail=20

<span class="comment"># Task 2: Filter for errors and warnings</span>
echo ""
echo "=== Errors and Warnings ==="
kubectl logs -n istio-system deploy/istiod --tail=100 | grep -iE "error|warn" | tail -10 || echo "No recent errors or warnings"

<span class="comment"># Task 3: Check xDS push events</span>
echo ""
echo "=== xDS Push Events ==="
kubectl logs -n istio-system deploy/istiod --tail=100 | grep -i "push" | tail -5 || echo "No recent push events"

<span class="comment"># Task 4: Check CA/certificate logs</span>
echo ""
echo "=== Certificate Events ==="
kubectl logs -n istio-system deploy/istiod --tail=100 | grep -iE "cert|ca|sign" | tail -5 || echo "No recent cert events"

<span class="comment"># Check Istiod health</span>
echo ""
echo "=== Istiod Health ==="
kubectl get pods -n istio-system -l app=istiod -o wide

<span class="comment"># Check control plane version</span>
echo ""
echo "=== Control Plane Info ==="
istioctl version</pre>
                        </div>

                        <div class="tip-box">
                            <h4>üí° Exam Tip</h4>
                            <p><strong>Key Istiod log patterns:</strong><br>
                            ‚Ä¢ <code>Push</code>: Configuration pushed to proxies<br>
                            ‚Ä¢ <code>cert</code>: Certificate operations<br>
                            ‚Ä¢ <code>error</code>/<code>warn</code>: Problems to investigate<br>
                            ‚Ä¢ <code>ads</code>: Aggregated Discovery Service events<br>
                            Use <code>--since=5m</code> to limit time range.</p>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title expected">üìä Expected Result</div>
                        <div class="expected-box">
                            <h4>‚úì Verification Checklist</h4>
                            <ul>
                                <li>Istiod pod is Running</li>
                                <li>Logs show normal operation (push events)</li>
                                <li>No persistent errors in logs</li>
                                <li>Version command shows control plane version</li>
                            </ul>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title cleanup">üßπ Cleanup</div>
                        <div class="code-container">
                            <div class="code-header"><span class="code-lang bash">bash</span><button class="copy-btn" onclick="copyCode(this)">Copy</button></div>
<pre><span class="comment"># No cleanup needed</span></pre>
                        </div>
                    </div>

                    <div class="sub-section">
                        <div class="sub-section-title reference">üìö References</div>
                        <div class="reference-links">
                            <a href="https://istio.io/latest/docs/ops/diagnostic-tools/component-logging/" target="_blank" class="ref-link">üìñ Component Logging</a>
                            <a href="https://istio.io/latest/docs/ops/common-problems/network-issues/" target="_blank" class="ref-link">üìñ Network Issues</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Domain 4 Complete Summary -->
            <div class="domain-summary troubleshoot">
                <div class="domain-summary-header">
                    <div class="domain-summary-icon">üîß</div>
                    <div class="domain-summary-title">Domain 4 Complete: Troubleshooting</div>
                </div>
                <div class="domain-summary-grid">
                    <div class="domain-summary-item"><span class="q-num">Q37</span><span class="q-title">istioctl analyze</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q38</span><span class="q-title">proxy-status (Sync Check)</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q39</span><span class="q-title">proxy-config clusters</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q40</span><span class="q-title">proxy-config routes</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q41</span><span class="q-title">proxy-config listeners</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q42</span><span class="q-title">proxy-config endpoints</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q43</span><span class="q-title">Debug Sidecar Injection</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q44</span><span class="q-title">Envoy Access Logs</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q45</span><span class="q-title">istioctl x describe</span></div>
                    <div class="domain-summary-item"><span class="q-num">Q46</span><span class="q-title">Istiod Control Plane Logs</span></div>
                </div>
            </div>

            <!-- All Domains Complete -->
            <div class="final-summary">
                <h3>üéâ All Domains Complete!</h3>
                <p>You've completed all 46 practice questions. Review the domain breakdown below.</p>
                <div class="final-summary-stats">
                    <div class="final-stat install">
                        <div class="final-stat-value">12</div>
                        <div class="final-stat-label">Installation ‚Ä¢ 20%</div>
                    </div>
                    <div class="final-stat traffic">
                        <div class="final-stat-value">12</div>
                        <div class="final-stat-label">Traffic Mgmt ‚Ä¢ 35%</div>
                    </div>
                    <div class="final-stat security">
                        <div class="final-stat-value">12</div>
                        <div class="final-stat-label">Security ‚Ä¢ 20%</div>
                    </div>
                    <div class="final-stat troubleshoot">
                        <div class="final-stat-value">10</div>
                        <div class="final-stat-label">Troubleshooting ‚Ä¢ 20%</div>
                    </div>
                </div>
                <div class="good-luck">üöÄ Good luck on your ICA exam!</div>
            </div>

        </div>
    </section>

    <footer>
        <div class="footer-links">
            <a href="https://istio.io/latest/docs/" target="_blank">Istio Documentation</a>
            <a href="https://training.linuxfoundation.org/certification/istio-certified-associate-ica/" target="_blank">ICA Certification</a>
            <a href="https://istio.io/latest/docs/ops/diagnostic-tools/" target="_blank">Diagnostic Tools</a>
        </div>
        <p class="footer-credit">ICA Practice Questions ‚Ä¢ 46 Hands-On Lab Exercises</p>
    </footer>

    <script>
        function toggleQuestion(header) {
            const card = header.closest('.question-card');
            card.classList.toggle('open');
        }

        function copyCode(btn) {
            const pre = btn.closest('.code-container').querySelector('pre');
            navigator.clipboard.writeText(pre.innerText).then(() => {
                btn.textContent = 'Copied!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'Copy';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }

        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href'))?.scrollIntoView({ behavior: 'smooth' });
            });
        });
    </script>
</body>
</html>
